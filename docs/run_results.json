<<<<<<< HEAD
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.10", "generated_at": "2025-12-16T16:32:32.536369Z", "invocation_id": "b72f0069-a285-461b-843a-300b77749dad", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T16:32:27.741069Z", "completed_at": "2025-12-16T16:32:27.752395Z"}, {"name": "execute", "started_at": "2025-12-16T16:32:27.752770Z", "completed_at": "2025-12-16T16:32:32.525291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.7856285572052, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.fait_demande_et_radiation_annee", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table de fait demande et radiation\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_demande_et_radiation_sne\n * Cible :          fait_demande_et_radiation_annee  \n\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n \ncte_demande_et_radiation_sne as\n(\n    select \n        [demande_et_radiation_sne_millesime],\n        [demande_et_radiation_sne_millesime_date],\n        -- [demande_et_radiation_sne_millesime_last_flag],\n        -- [demande_numero],\n        [demande_id],\n        [demande_creation_date],\n        -- [demande_motif_premier_code],\n        [demande_nouvelle_flag],\n        -- [demande_anciennete_jour_nombre],\n        -- [demande_anciennete_mois_nombre],\n        [demande_anciennete_annee_nombre],\n        -- [cerfa_version_code],\n        -- [demandeur_type_code],\n        -- [demandeur_naissance_date],\n        -- [demandeur_age],\n        -- [demandeur_age_tranche_code],\n        -- [demandeur_statut_professionnel_code],\n        -- [demandeur_situation_familiale_code],\n        -- [demandeur_composition_familiale_code],\n        -- [demandeur_revenu_mensuel_montant],\n        [foyer_taille],\n        [foyer_taille_plafond],\n        -- [cotitulaire_nombre],\n        -- [personne_a_charge_nombre],\n        -- [unite_de_consommation_nombre],\n        -- [handicape_nombre], \n        [foyer_personne_isole_flag],\n        [foyer_couple_flag],\n        [foyer_famille_monoparentale_flag],\n        [foyer_enfant_nombre],\n        -- [foyer_conjoint_age],\n        -- [foyer_couple_age], \n        -- [foyer_jeune_menage],\n        -- [foyer_revenu_mensuel_montant],\n        -- [foyer_revenu_fiscal_1_montant],\n        [foyer_revenu_fiscal_2_montant],\n        -- [apl_mensuel_montant],\n        -- [logement_actuel_categorie_logement_code],\n        -- [logement_actuel_piece_nombre_code],\n        [logement_actuel_mode_logement_code],\n        [logement_actuel_zone_plafond_ressource_code],\n        [logement_actuel_commune_code],\n        -- [logement_actuel_arrondissement_code],\n        -- [logement_recherche_categorie_logement_code],\n        -- [logement_recherche_piece_nombre_code],\n        -- [logement_recherche_commune_code],\n        -- [logement_recherche_zone_plafond_ressource_code],\n        -- [logement_recherche_arrondissement_code],\n        -- [logement_rpls_id],\n        -- [logement_attribue_piece_nombre_code],\n        -- [logement_attribue_commune_code],\n        -- [logement_attribue_arrondissement_code],\n        -- [logement_attribue_zone_plafond_ressource_code],\n        [attribution_date],\n        -- [attribution_delai_jour_nombre],\n        -- [attribution_delai_mois_nombre],\n        [attribution_flag],\n        [mutation_flag],\n        -- [piece_nombre_adequation_code],\n        -- [reservataire_type_code],\n        -- [radiation_date],\n        -- [radiation_motif_code],\n        [radiation_hors_attribution_flag],\n        -- [radiation_flag],\n        -- [radiation_siren_numero],\n        -- [dalo_statut_code],\n        [dalo_flag],\n        [qpv_flag]\n        -- [demande_et_radiation_sne_hk],\n        -- [demande_et_radiation_sne_bk],\n        -- [logement_attribue_zone_plafond_ressource_hk],\n        -- [reservataire_type_hk],\n        -- [radiation_motif_hk],\n        -- [dalo_statut_hk],\n        -- [logement_recherche_categorie_logement_hk],\n        -- [logement_recherche_piece_nombre_hk],\n        -- [logement_recherche_zone_plafond_ressource_hk],\n        -- [logement_recherche_commune_hk],\n        -- [logement_recherche_commune_bk],\n        -- [logement_recherche_arrondissement_hk],\n        -- [logement_recherche_arrondissement_bk],\n        -- [logement_actuel_categorie_logement_hk],\n        -- [logement_actuel_piece_nombre_hk],\n        -- [logement_actuel_mode_logement_hk],\n        -- [logement_actuel_zone_plafond_ressource_hk],\n        -- [logement_actuel_commune_hk],\n        -- [logement_actuel_commune_bk],\n        -- [logement_actuel_arrondissement_hk],\n        -- [logement_actuel_arrondissement_bk],\n        -- [demandeur_composition_familiale_hk],\n        -- [demandeur_situation_familiale_hk],\n        -- [demandeur_statut_professionnel_hk],\n        -- [demandeur_age_tranche_hk],\n        -- [demande_motif_premier_hk],\n       \n                   \n         \n\n    from\n        \"wh_dp_silver\".\"dbo\".\"demande_et_radiation_sne\"\n\n),\n\ncte_dim_demande_anciennete_tranche as\n(\n    select \n        demande_anciennete_tranche_hk\n        , demande_anciennete_tranche_code\n        , demande_anciennete_tranche_min\n        , demande_anciennete_tranche_max\n    from \n        \"wh_dp_gold\".\"dbo\".\"dim_demande_anciennete_tranche\"\n),\n\ncte_ref_ressource_plafond as\n(\n    select\n        taille\n        , zone_ps\n        , annee\n        , plai\n        , pls\n        , plus\n    from \n        \"wh_dp_bronze\".\"seed\".\"ref_ressource_plafond\"\n),\n\ncte_map_composition_familiale as\n(\n    select\n        composition_familiale_code\n        , foyer_personne_isole_flag\n        , foyer_couple_flag\n        , foyer_famille_monoparentale_flag\n        , foyer_enfant_nombre\n    from \n        \"wh_dp_bronze\".\"seed\".\"map_composition_familiale\"\n\n),\n\n/* cte_commune as\n(\n    select \n        commune_annee,\n        commune_annee_last_flag,\n        commune_code,\n        commune_hk,\n        commune_bk\n         \n    from \n        \"wh_dp_silver\".\"dbo\".\"commune\"\n)\n------------------------------------------------------------------\n--*************************** FILTRES *****************************\n-------------------------------------------------------------------\n cte_commune_last as\n (\n    select * from cte_commune\n    where commune.commune_annee_last_flag = 1\n ) */\n\n\n\n-------------------------------------------------------------------\n--************************* TRAITEMENTS ***************************\n-------------------------------------------------------------------\n\n \n-- Pr\u00e9paration des axes d'analyses\ncte_transform_demande_et_radiation_sne as\n(\n    select\n        sne.*\n        , anciennete.demande_anciennete_tranche_code\n        , anciennete.demande_anciennete_tranche_hk\n        , \n    case\n        when sne.foyer_revenu_fiscal_2_montant is null then 'N/A'\n        when sne.foyer_revenu_fiscal_2_montant <= 0 then '0'\n        when sne.foyer_revenu_fiscal_2_montant > 0 and sne.foyer_revenu_fiscal_2_montant <= ressource.plai then 'PLAI'\n        when sne.foyer_revenu_fiscal_2_montant > ressource.plai and sne.foyer_revenu_fiscal_2_montant <= ressource.plus then 'PLAI_PLUS'\n        when sne.foyer_revenu_fiscal_2_montant > ressource.plus and sne.foyer_revenu_fiscal_2_montant <= ressource.pls then 'PLUS_PLS'\n        when sne.foyer_revenu_fiscal_2_montant > ressource.pls then 'PLS'\n        else 'N/A'\n    end\n    as revenu_plafond_tranche_code\n        , isnull(map_composition.composition_familiale_code,  'autres' )\n                as composition_familiale_code\n    from \n        cte_demande_et_radiation_sne sne  \n    left join cte_dim_demande_anciennete_tranche anciennete \n        on (sne.demande_anciennete_annee_nombre between anciennete.demande_anciennete_tranche_min and anciennete.demande_anciennete_tranche_max) \n    left join cte_ref_ressource_plafond ressource\n        on (sne.foyer_taille_plafond = ressource.taille and sne.logement_actuel_zone_plafond_ressource_code = ressource.zone_ps and sne.demande_et_radiation_sne_millesime = ressource.annee)\n    left join cte_map_composition_familiale map_composition \n        on (    sne.foyer_personne_isole_flag = map_composition.foyer_personne_isole_flag\n            and sne.foyer_couple_flag = map_composition.foyer_couple_flag\n            and sne.foyer_famille_monoparentale_flag = map_composition.foyer_famille_monoparentale_flag\n            and sne.foyer_enfant_nombre = map_composition.foyer_enfant_nombre)\n),\n \n\n \n-- Calcul des indicateurs et aggr\u00e9gation\n cte_calc_demande_et_radiation_sne as \n (\n    select\n         *\n    \n\n    from \n        cte_transform_demande_et_radiation_sne\n    \n   \n ),\n\n -- Calcul des cl\u00e9s techniques pour celles qui ne sont pas directement r\u00e9cup\u00e9r\u00e9es de la couche silver\ncte_hk_calc_demande_et_radiation_sne as\n (\n    select     \n        cte_calc_demande_et_radiation_sne.*\n\n  \n    from \n        cte_calc_demande_et_radiation_sne\n ),\n        \n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n \ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from\n        cte_hk_calc_demande_et_radiation_sne\n)\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_gold\".\"dbo\".\"fait_demande_et_radiation_annee\"", "batch_results": null}], "elapsed_time": 6.6460795402526855, "args": {"strict_mode": false, "macro_debugging": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level_file": "debug", "profiles_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "write_json": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "populate_cache": true, "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "exclude": [], "project_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "version_check": true, "indirect_selection": "eager", "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "partial_parse": true, "defer": false, "log_file_max_bytes": 10485760, "select": ["fait_demande_et_radiation_annee"], "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "log_path": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform\\logs", "require_resource_names_without_spaces": false, "use_colors_file": true, "state_modified_compare_vars": false, "invocation_command": "dbt run -s fait_demande_et_radiation_annee", "show_resource_report": false, "static_parser": true, "quiet": false, "which": "run", "empty": false, "print": true, "log_level": "info", "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "printer_width": 80}}
=======
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.10", "generated_at": "2025-12-15T14:06:29.603029Z", "invocation_id": "8d61ed1a-ebed-403e-9f82-800f1ee0349f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T14:06:27.663860Z", "completed_at": "2025-12-15T14:06:27.671224Z"}, {"name": "execute", "started_at": "2025-12-15T14:06:27.671604Z", "completed_at": "2025-12-15T14:06:29.592709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.930044174194336, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.dim_piece_nombre_adequation", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table dim_piece_nombre_adequation\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          piece_nombre_adequation\n * Cible :          dim_piece_nombre_adequation \n */\n\n\n\n\n\n    select\n        *\n    from \"wh_dp_silver\".\"dbo\".\"piece_nombre_adequation\"\n", "relation_name": "\"wh_dp_gold\".\"dbo\".\"dim_piece_nombre_adequation\"", "batch_results": null}], "elapsed_time": 3.7045254707336426, "args": {"profiles_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "require_explicit_package_overrides_for_builtin_materializations": true, "print": true, "defer": false, "select": ["dim_piece_nombre_adequation"], "macro_debugging": false, "send_anonymous_usage_stats": true, "exclude": [], "log_level": "info", "partial_parse_file_diff": true, "log_format": "default", "show_resource_report": false, "log_file_max_bytes": 10485760, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "cache_selected_only": false, "use_colors": true, "version_check": true, "empty": false, "log_path": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform\\logs", "require_batched_execution_for_custom_microbatch_strategy": false, "which": "run", "introspect": true, "invocation_command": "dbt run -s dim_piece_nombre_adequation", "log_format_file": "debug", "require_resource_names_without_spaces": false, "vars": {}, "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "favor_state": false, "require_nested_cumulative_type_params": false, "write_json": true, "strict_mode": false, "log_level_file": "debug", "printer_width": 80, "populate_cache": true, "partial_parse": true, "project_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "quiet": false}}
>>>>>>> develop
