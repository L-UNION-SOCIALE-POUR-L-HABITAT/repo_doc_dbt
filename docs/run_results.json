{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-12-09T16:58:44.272566Z", "invocation_id": "ae6d41da-4be5-4dec-889e-4321d8841221", "invocation_started_at": "2025-12-09T16:58:31.585729Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:34.327946Z", "completed_at": "2025-12-09T16:58:34.335100Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:34.335492Z", "completed_at": "2025-12-09T16:58:36.446930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.12027907371521, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_crm_entreprise", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_crm_entreprise\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          raw_crm_entreprise\n * Cible :          stg_crm_entreprise\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_entreprise as \n (\n    select \n        [codeUnion]             as organisme_code_union,\n        [name]                  as organisme_raison_sociale_libelle,\n        [organizationStatut]    as organisme_statut_code,\n        [organizationType]      as organisme_type_code,\n        [siren]                 as organisme_siren_code,\n        [subfamily]             as organisme_sous_famille_code,\n        [id]                    as organisme_id_code\n      \n    from   \"wh_dp_bronze\".\"raw\".\"raw_crm_entreprise\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_entreprise as \n (\n    select\n        *\n       \n    from  cte_rename_raw_entreprise\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_entreprise\n)\n \n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_crm_entreprise\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:36.452916Z", "completed_at": "2025-12-09T16:58:36.457605Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:36.458135Z", "completed_at": "2025-12-09T16:58:37.855436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4037659168243408, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_crm_personne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_crm_personne\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          raw_crm_personne\n * Cible :          stg_crm_personne\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_personne as \n (\n    select \n        [PerID]                  as personne_id_code,\n        [PerCivID]               as personne_civilite_id_code,\n        [EntOrgType]             as organisme_type_code,\n        [EntOrgTypeLabel]        as organisme_type_libelle,\n        [PerEntID]               as organisme_id_code,\n        [EntCodeUnion]           as organisme_code_union,\n        [EntSiren]               as organisme_siren_code,\n        [PerLdapName_]           as personne_ldap_code,\n        [PerFstName]             as personne_prenom_libelle,\n        [PerName]                as personne_nom_libelle,\n        [PerTitle]               as personne_titre_libelle,\n        [PerFctID]               as personne_fonction_code,\n        [PerFctLabel]            as personne_fonction_libelle,\n        [PerMail]                as personne_email_libelle,\n        [PerDataPrivStatus]      as personne_statut_code,\n        [PerRolesApplication1_]  as personne_role_libelle\n\n\n    from   \"wh_dp_bronze\".\"raw\".\"raw_crm_personne\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_personne as \n (\n    select\n        *\n       \n    from  cte_rename_raw_personne\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_personne\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_crm_personne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:37.860924Z", "completed_at": "2025-12-09T16:58:37.866088Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:37.866455Z", "completed_at": "2025-12-09T16:58:39.677055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8171663284301758, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_organisme", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_organisme\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          stg_crm_entreprise\n * Cible :          int_organisme\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_stg_entreprise as \n(\n    select \n        organisme_raison_sociale_libelle,\n        organisme_statut_code,\n        organisme_type_code,\n        organisme_siren_code,\n        coalesce(organisme_sous_famille_code,'N/A') as organisme_sous_famille_code, \n        organisme_code_union,\n        organisme_id_code\n        \n    from \n        \"wh_dp_silver\".\"stg\".\"stg_crm_entreprise\"\n),\n/*\ncte_stg_reference as\n(\n\n),\n\ncte_stg_orfi_group as \n(\n\n)\n*/\n\n \n-------------------------------------------------------------------\n--************************** FILTRAGE ****************************\n-------------------------------------------------------------------\n-- on souhaite recueperer que les organismes actifs\ncte_filter_stg_entreprise as \n(\n    select \n        *\n        \n    from \n        cte_stg_entreprise\n\n    where organisme_statut_code = 'ACT'\n        and organisme_code_union IS NOT NULL\n),\n\n-------------------------------------------------------------------\n--************* JOINTURE ET COLONNES CALCULEES ********************\n-------------------------------------------------------------------\ncte_calc_stg_entreprise  as \n (\n    select\n        *\n    \n    from cte_filter_stg_entreprise\n\n    --left join cte_stg_reference on ....\n    --left join cte_stg_orfi_group on ....\n ),\n\n\n-------------------------------------------------------------------\n--********************** CLES TECHNIQUES *************************\n-------------------------------------------------------------------\ncte_hk_calc_stg_entreprise as\n(\n    select \n        *\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(organisme_code_union as varchar(max))\n    \n)  \n \n         as organisme_code_union_hk\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(organisme_statut_code as varchar(max))\n    \n)  \n \n       as organisme_statut_hk\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(organisme_type_code as varchar(max))\n    \n)  \n \n         as organisme_type_code_hk\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(organisme_sous_famille_code as varchar(max))\n    \n)  \n \n  as organisme_sous_famille_hk\n         \n    from \n        cte_calc_stg_entreprise\n),\n \n-------------------------------------------------------------------\n--********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\n \n cte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_entreprise\n )\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_organisme\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:39.681082Z", "completed_at": "2025-12-09T16:58:39.686156Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:39.686532Z", "completed_at": "2025-12-09T16:58:41.410553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7305636405944824, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_personne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_organisme\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          stg_crm_entreprise\n * Cible :          int_organisme\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_stg_personne as \n(\n    select \n        personne_id_code,\n        organisme_type_code,\n        organisme_type_libelle,\n        organisme_siren_code,\n        organisme_code_union,\n        organisme_id_code,\n        personne_ldap_code,\n        personne_prenom_libelle,\n        personne_nom_libelle,\n        personne_titre_libelle,\n        personne_fonction_code,\n        personne_fonction_libelle,\n        personne_email_libelle,\n        personne_statut_code,\n        personne_role_libelle\n\n\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_crm_personne\"\n),\n\n\n\n\n/*\ncte_stg_reference as\n(\n\n),\n\ncte_stg_orfi_group as \n(\n\n)\n*/\n\n \n-------------------------------------------------------------------\n--************************** FILTRAGE ****************************\n-------------------------------------------------------------------\n-- on souhaite recueperer que les organismes actifs\ncte_filter_stg_personne as \n(\n    select \n        *\n        \n    from \n        cte_stg_personne\n\n    where personne_statut_code = 'Active'\n        and personne_ldap_code IS NOT NULL\n),\n\n-------------------------------------------------------------------\n--************* JOINTURE ET COLONNES CALCULEES ********************\n-------------------------------------------------------------------\ncte_calc_stg_personne  as \n (\n    select\n        personne_id_code,\n        organisme_type_code,\n        organisme_type_libelle,\n        organisme_siren_code,\n        organisme_code_union,\n        organisme_id_code,\n        coalesce(personne_ldap_code,'N/A') as personne_ldap_code, \n        personne_prenom_libelle,\n        personne_nom_libelle,\n        personne_titre_libelle,\n        personne_fonction_code,\n        personne_fonction_libelle,\n        personne_email_libelle,\n        personne_statut_code,\n        personne_role_libelle\n    \n    from cte_filter_stg_personne\n    --left join cte_stg_reference on ....\n    --left join cte_stg_orfi_group on ....\n ),\n\n\n-------------------------------------------------------------------\n--********************** CLES TECHNIQUES *************************\n-------------------------------------------------------------------\ncte_hk_calc_stg_personne as\n(\n    select \n        *\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(personne_ldap_code as varchar(max))\n    \n)  \n \n           as personne_ldap_code_hk\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(organisme_code_union as varchar(max))\n    \n)  \n \n         as organisme_code_union_hk\n         \n    from \n        cte_calc_stg_personne\n),\n \n-------------------------------------------------------------------\n--********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\n \n cte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_personne\n )\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_personne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:41.416456Z", "completed_at": "2025-12-09T16:58:41.420841Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:41.421404Z", "completed_at": "2025-12-09T16:58:42.737193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.322380781173706, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.organisme", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table organisme\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          int_organisme\n * Cible :          organisme\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_organisme as\n(\n    select\n        organisme_code_union_hk,\n        organisme_code_union,\n        organisme_raison_sociale_libelle,\n        organisme_statut_hk,\n        organisme_statut_code,\n        organisme_type_code_hk,\n        organisme_type_code,\n        organisme_siren_code,\n        organisme_sous_famille_hk,\n        organisme_sous_famille_code,\n        organisme_id_code\n\n    from \"wh_dp_silver\".\"int\".\"int_organisme\"\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_organisme\n)\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbi\".\"organisme\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T16:58:42.742248Z", "completed_at": "2025-12-09T16:58:42.746416Z"}, {"name": "execute", "started_at": "2025-12-09T16:58:42.746783Z", "completed_at": "2025-12-09T16:58:44.265109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.524052381515503, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.personne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table personne\n * Fr\u00e9quence :      Quotidienne\n * Mode :           Annule et remplace\n * Source:          int_organisme\n * Cible :          organisme\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_personne as\n(\n    select\n        personne_id_code,\n        personne_ldap_code_hk,\n        personne_ldap_code,\n        organisme_type_code,\n        organisme_type_libelle,\n        organisme_siren_code,\n        organisme_code_union_hk,\n        organisme_code_union,\n        organisme_id_code,\n        personne_prenom_libelle,\n        personne_nom_libelle,\n        personne_titre_libelle,\n        personne_fonction_code,\n        personne_fonction_libelle,\n        personne_email_libelle,\n        personne_statut_code,\n        personne_role_libelle\n\n    from \"wh_dp_silver\".\"int\".\"int_personne\"\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_personne\n)\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbi\".\"personne\"", "batch_results": null}], "elapsed_time": 11.059332132339478, "args": {"require_yaml_configuration_for_mf_time_spines": false, "print": true, "empty": false, "cache_selected_only": false, "use_fast_test_edges": false, "quiet": false, "invocation_command": "dbt run -s tag:annuaire", "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "show_all_deprecations": false, "log_format": "default", "require_resource_names_without_spaces": true, "state_modified_compare_vars": false, "validate_macro_args": false, "macro_debugging": false, "vars": {}, "use_colors": true, "static_parser": true, "write_json": true, "log_path": "C:\\Users\\nitissier\\dbt_projects\\dbt_dataplatform\\logs", "printer_width": 80, "require_all_warnings_handled_by_warn_error": false, "require_generic_test_arguments_property": true, "use_colors_file": true, "which": "run", "strict_mode": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "log_level": "info", "populate_cache": true, "select": ["tag:annuaire"], "log_level_file": "debug", "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "source_freshness_run_project_hooks": true, "profiles_dir": "C:\\Users\\nitissier\\dbt_projects\\dbt_dataplatform", "upload_to_artifacts_ingest_api": false, "project_dir": "C:\\Users\\nitissier\\dbt_projects\\dbt_dataplatform", "version_check": true, "indirect_selection": "eager", "exclude": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "partial_parse": true, "show_resource_report": false, "defer": false}}