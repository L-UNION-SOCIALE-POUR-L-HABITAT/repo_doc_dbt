{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.10", "generated_at": "2025-12-10T16:40:28.229440Z", "invocation_id": "742572f1-f133-436b-b8b2-2ac5e32f4ee2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:23:49.932388Z", "completed_at": "2025-12-10T16:23:49.948788Z"}, {"name": "execute", "started_at": "2025-12-10T16:23:49.949160Z", "completed_at": "2025-12-10T16:23:52.010162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.079047203063965, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demandeur_age_tranche", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demandeur_age_tranche\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          ref_dataplatform\n * Cible :          demandeur_age_tranche\n */\n\n\n\n-- Selection des tables et des colonnes\nwith cte_ref_dataplatform as\n(\n    select \n        objet,\n        code, \n        libelle,\n        val1,\n        val2\n    from   \n        \"wh_dp_bronze\".\"seed\".\"ref_dataplatform\"\n),\n\ncte_default_table as\n(\n    select \n        \n        'N/A'          as demandeur_age_tranche_code,\n        'Non disponible'  as demandeur_age_tranche_libelle_court,\n        'Non disponible'  as demandeur_age_tranche_libelle_long,\n        CAST(NULL AS INTEGER)            as demandeur_age_tranche_min,\n        CAST(NULL AS INTEGER)            as demandeur_age_tranche_max\n            \n),\n---\n\n-- Filtre et renommage\ncte_demandeur_age_tranche as \n(\n    select \n        code                as demandeur_age_tranche_code,\n        libelle             as demandeur_age_tranche_libelle_court,\n        libelle             as demandeur_age_tranche_libelle_long,\n        val1                as demandeur_age_tranche_min,\n        val2                as demandeur_age_tranche_max\n    from \n        cte_ref_dataplatform\n    where \n        objet = 'demandeur_age_tranche'\n\n),\n\n\n\n-- Formatage\ncte_cast_demandeur_age_tranche as\n(\n    select  \n        demandeur_age_tranche_code,\n        demandeur_age_tranche_libelle_court,\n        demandeur_age_tranche_libelle_long,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_age_tranche_min is null \n          or demandeur_age_tranche_min in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_age_tranche_min as integer) is not null \n        then cast(demandeur_age_tranche_min as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_age_tranche_min as float) is not null \n        then cast(cast(demandeur_age_tranche_min as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as demandeur_age_tranche_min,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_age_tranche_max is null \n          or demandeur_age_tranche_max in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_age_tranche_max as integer) is not null \n        then cast(demandeur_age_tranche_max as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_age_tranche_max as float) is not null \n        then cast(cast(demandeur_age_tranche_max as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as demandeur_age_tranche_max\n\n    from \n        cte_demandeur_age_tranche\n),\n\n-- union\ncte_union_demandeur_age_tranche as\n(\n    select \n        *\n    from \n        cte_cast_demandeur_age_tranche\n    union\n    select  \n        *\n    from \n        cte_default_table\n),\n\n-- Ajout des cl\u00e9s techniques\ncte_hk_demandeur_age_tranche as\n(\n    select \n        *\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_age_tranche_code as varchar(max))\n    \n)  \n \n   as demandeur_age_tranche_hk\n         \n\n    from \n        cte_union_demandeur_age_tranche\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_demandeur_age_tranche\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demandeur_age_tranche\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:23:52.017212Z", "completed_at": "2025-12-10T16:23:52.025407Z"}, {"name": "execute", "started_at": "2025-12-10T16:23:52.026200Z", "completed_at": "2025-12-10T16:23:53.495288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4795875549316406, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.piece_nombre_adequation", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table piece_nombre_adequation\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          ref_dataplatform\n * Cible :          piece_nombre_adequation\n */\n\n\n\n-- Selection des tables et des colonnes\nwith cte_ref_dataplatform as\n(\n    select \n        objet,\n        code, \n        libelle,\n        val1 \n    from   \n        \"wh_dp_bronze\".\"seed\".\"ref_dataplatform\"\n),\n\n-- Filtre et renommage\ncte_piece_nombre_adequation as \n(\n    select \n        code                as piece_nombre_adequation_code,\n        libelle             as piece_nombre_adequation_libelle_court,\n        libelle             as piece_nombre_adequation_libelle_long,\n        val1                as piece_nombre_adequation_ordre_affichage\n       \n    from \n        cte_ref_dataplatform\n    where \n        objet = 'piece_nombre_adequation'\n\n),\n\n-- Formatage\ncte_cast_piece_nombre_adequation as\n(\n    select  \n        piece_nombre_adequation_code,\n        piece_nombre_adequation_libelle_court,\n        piece_nombre_adequation_libelle_long,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when piece_nombre_adequation_ordre_affichage is null \n          or piece_nombre_adequation_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(piece_nombre_adequation_ordre_affichage as integer) is not null \n        then cast(piece_nombre_adequation_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(piece_nombre_adequation_ordre_affichage as float) is not null \n        then cast(cast(piece_nombre_adequation_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as piece_nombre_adequation_ordre_affichage\n       \n\n    from \n        cte_piece_nombre_adequation\n),\n\n\n-- Ajout des cl\u00e9s techniques\ncte_hk_piece_nombre_adequation as\n(\n    select \n        *\n        , \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(piece_nombre_adequation_code as varchar(max))\n    \n)  \n \n   as piece_nombre_adequation_hk\n         \n\n    from \n        cte_cast_piece_nombre_adequation\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_piece_nombre_adequation\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"piece_nombre_adequation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:23:53.500306Z", "completed_at": "2025-12-10T16:23:53.509224Z"}, {"name": "execute", "started_at": "2025-12-10T16:23:53.509936Z", "completed_at": "2025-12-10T16:24:14.450349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 20.951388359069824, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ele_classement_commune", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_ele_classement_commune\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_ele_classement_commune\n * Cible :          stg_gipsne_ele_classement_commune\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_ele_classement_commune as \n (\n    select \n        [DEMANDE]           as demande_commune_recherche_demande_id,\n        [ORDRE]             as demande_commune_recherche_ordre_priorite,\n        [COMMUNE_ID]        as demande_commune_recherche_commune_cle,\n        [_meta_year]        as demande_commune_recherche_annee\n        --[QUARTIER]             \n\n    from   \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ele_classement_commune\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_ele_classement_commune as \n (\n    select\n        demande_commune_recherche_demande_id,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_commune_recherche_ordre_priorite is null \n          or demande_commune_recherche_ordre_priorite in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_commune_recherche_ordre_priorite as integer) is not null \n        then cast(demande_commune_recherche_ordre_priorite as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_commune_recherche_ordre_priorite as float) is not null \n        then cast(cast(demande_commune_recherche_ordre_priorite as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n  \n                        as demande_commune_recherche_ordre_priorite, \n        demande_commune_recherche_commune_cle,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_commune_recherche_annee is null \n          or demande_commune_recherche_annee in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_commune_recherche_annee as integer) is not null \n        then cast(demande_commune_recherche_annee as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_commune_recherche_annee as float) is not null \n        then cast(cast(demande_commune_recherche_annee as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n     \n                        as demande_commune_recherche_annee \n       \n    from  cte_rename_raw_gipsne_ele_classement_commune\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_ele_classement_commune\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_classement_commune\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:24:14.453647Z", "completed_at": "2025-12-10T16:24:14.460989Z"}, {"name": "execute", "started_at": "2025-12-10T16:24:14.461424Z", "completed_at": "2025-12-10T16:24:55.921112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 41.46873164176941, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ele_desc_foyer_demande", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_ele_desc_foyer_demande\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_ele_desc_foyer_demande\n * Cible :          stg_gipsne_ele_desc_foyer_demande\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_ele_desc_foyer_demande as \n (\n    select \n        [DEMANDE]                       as demandeur_foyer_demande_id,\n        [TYPE_PERSONNE]                 as demandeur_type_code,\n        [DATENAISSANCE]                 as demandeur_foyer_naissance_date,\n        [AGE]                           as demandeur_foyer_age,\n        [ORDRE]                         as demandeur_foyer_ordre_affichage,\n        [ELEMENTLIENDEMANDEUR_ID]       as demandeur_lien_cle,\n        [_meta_year]                    as demandeur_foyer_annee\n        -- [ELEMENTCIVILITE_ID],\n        -- [SITUATIONPROFESSIONNELLE_ID],\n        -- [ELEMENTNATIONALITE_ID],\n        -- [ELEMENTSITUATIONFAMILIALE_ID],\n        -- [REVENU_MENSUEL],\n        -- [ANNEEMOINS1],\n        -- [REVENU_FISCAL_ANNEEMOINS1],\n        -- [ANNEEMOINS2],\n        -- [REVENU_FISCAL_ANNEEMOINS2],\n        -- [QUOTIENT_UC],\n        -- [MULTI_EMPLOYEUR],\n        -- [NIR_ID_DEMANDEUR],\n        -- [NIR_ID_COTITULAIRE],\n        -- [NB_CDD_INTERIM],\n        -- [NB_CHOMAGE_LONG],\n        -- [DATE_SORTIE_CHOMAGELONG],\n        -- [NB_TRAVAILLEUR_ESSENTIEL],\n      \n    \n\n    from   \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ele_desc_foyer_demande\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_ele_desc_foyer_demande as \n (\n    select\n        demandeur_foyer_demande_id,\n        demandeur_type_code,\n        \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demandeur_foyer_naissance_date is null or trim(demandeur_foyer_naissance_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demandeur_foyer_naissance_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(demandeur_foyer_naissance_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(demandeur_foyer_naissance_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(demandeur_foyer_naissance_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(demandeur_foyer_naissance_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(demandeur_foyer_naissance_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(demandeur_foyer_naissance_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(demandeur_foyer_naissance_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n \n                                                                    as demandeur_foyer_naissance_date,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_foyer_age is null \n          or demandeur_foyer_age in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_foyer_age as integer) is not null \n        then cast(demandeur_foyer_age as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_foyer_age as float) is not null \n        then cast(cast(demandeur_foyer_age as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n        as demandeur_foyer_age,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_foyer_ordre_affichage is null \n          or demandeur_foyer_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_foyer_ordre_affichage as integer) is not null \n        then cast(demandeur_foyer_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_foyer_ordre_affichage as float) is not null \n        then cast(cast(demandeur_foyer_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n  as demandeur_foyer_ordre_affichage, \n        demandeur_lien_cle,\n         \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_foyer_annee is null \n          or demandeur_foyer_annee in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_foyer_annee as integer) is not null \n        then cast(demandeur_foyer_annee as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_foyer_annee as float) is not null \n        then cast(cast(demandeur_foyer_annee as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n     as demandeur_foyer_annee \n       \n    from  cte_rename_raw_gipsne_ele_desc_foyer_demande\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_ele_desc_foyer_demande\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_desc_foyer_demande\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:24:55.925749Z", "completed_at": "2025-12-10T16:24:55.933408Z"}, {"name": "execute", "started_at": "2025-12-10T16:24:55.933989Z", "completed_at": "2025-12-10T16:24:58.450391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5259599685668945, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ele_information_dalo", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_ele_information_dalo\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_ele_information_dalo\n * Cible :          stg_gipsne_ele_information_dalo\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_ele_information_dalo as \n (\n    select \n        [DEMANDE]                       as demande_id,\n        [STATUT_DALO]                   as dalo_statut_cle,\n        [DATE_DECISION]                 as dalo_decision_date,\n        --[EST_DIAGNOSTIC_SOCIAL],\n        --[EST_ACCOMPAGNEMENT_SOCIAL],\n        --[TYPE_LOGEMENT_DALO],\n        [_meta_year]                    as dalo_annee\n      \n    from   \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ele_information_dalo\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_ele_information_dalo as \n (\n    select\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when dalo_annee is null \n          or dalo_annee in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(dalo_annee as integer) is not null \n        then cast(dalo_annee as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(dalo_annee as float) is not null \n        then cast(cast(dalo_annee as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                    as dalo_annee ,\n        demande_id,\n        dalo_statut_cle,\n        \n    case\n        -- Gestion des valeurs nulles ou vides\n        when dalo_decision_date is null or trim(dalo_decision_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(dalo_decision_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(dalo_decision_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(dalo_decision_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(dalo_decision_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(dalo_decision_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(dalo_decision_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(dalo_decision_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(dalo_decision_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n \n                    as dalo_decision_date\n        \n    from  cte_rename_raw_gipsne_ele_information_dalo\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_ele_information_dalo\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_information_dalo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:24:58.455933Z", "completed_at": "2025-12-10T16:24:58.461454Z"}, {"name": "execute", "started_at": "2025-12-10T16:24:58.462064Z", "completed_at": "2025-12-10T16:25:06.789194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.334704875946045, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ele_mode_logement_actuel", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_ele_mode_logement_actuel\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_ele_mode_logement_actuel\n * Cible :          stg_gipsne_ele_mode_logement_actuel\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_ele_mode_logement_actuel as \n (\n    select \n        [DEMANDE]                   as demande_mode_logement_actuel_demande_id,\n\t\t[ORDRE]                     as demande_mode_logement_actuel_ordre_affichage,\n\t\t[MODE_LOGEMENT_ACTUEL]      as demande_mode_logement_actuel_cle,\n\t\t[_meta_year]                as demande_mode_logement_actuel_annee\n\n    from   \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ele_mode_logement_actuel\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_ele_mode_logement_actuel as \n (\n    select\n        demande_mode_logement_actuel_demande_id,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_mode_logement_actuel_ordre_affichage is null \n          or demande_mode_logement_actuel_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_mode_logement_actuel_ordre_affichage as integer) is not null \n        then cast(demande_mode_logement_actuel_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_mode_logement_actuel_ordre_affichage as float) is not null \n        then cast(cast(demande_mode_logement_actuel_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n\n                    as demande_mode_logement_actuel_ordre_affichage,\n        demande_mode_logement_actuel_cle,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_mode_logement_actuel_annee is null \n          or demande_mode_logement_actuel_annee in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_mode_logement_actuel_annee as integer) is not null \n        then cast(demande_mode_logement_actuel_annee as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_mode_logement_actuel_annee as float) is not null \n        then cast(cast(demande_mode_logement_actuel_annee as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n  \n                    as demande_mode_logement_actuel_annee\n       \n    from  cte_rename_raw_gipsne_ele_mode_logement_actuel\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_ele_mode_logement_actuel\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_mode_logement_actuel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:25:06.793615Z", "completed_at": "2025-12-10T16:25:06.809184Z"}, {"name": "execute", "started_at": "2025-12-10T16:25:06.809991Z", "completed_at": "2025-12-10T16:26:11.041678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 64.24960589408875, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_radiation", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_radiation\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_radiation\n * Cible :          stg_gipsne_radiation\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_radiation as \n (\n    select \n        [_meta_year]                        as demande_et_radiation_sne_millesime,\n        [DEMANDE]                           as demande_id ,\n        [NUMERO_UNIQUE]                     as demande_numero ,\n        [TYPE_DEMANDEUR]                    as demandeur_type_code,\n        [DATE_CREATION]                     as demande_creation_date,\n        [MOTIF_DEMANDE]                     as demande_motif_premier_cle,\n        [DATE_NAISS_DEMANDEUR]              as demandeur_naissance_date,\n        [AGE_DEMANDEUR_DEMANDE]             as demandeur_age,\n        [SEXE_DEMANDEUR]                    as demandeur_sexe_cle,\n        [STATUT_PROF_DEMANDEUR]             as demandeur_statut_professionnel_cle,\n        [NATIONALITE_DEMANDEUR]             as demandeur_nationalite_cle,\n        [SITU_FAMILIALE_DEMANDEUR]          as demandeur_situation_familiale_cle,\n        [TAILLE_MENAGE]                     as foyer_taille,\n        [COTITULAIRE]                       as cotitulaire_nombre,\n        [PERSONNE_A_CHARGE]                 as personne_a_charge_nombre,\n        [COMPOSITION_FAMILLE]               as demandeur_composition_familiale_code,\n        [UNITE_CONSO]                       as unite_de_consommation_nombre,\n        [REVENU_DEMANDEUR]                  as demandeur_revenu_mensuel_montant,\n        [REVENU_MENSUEL_FOYER]              as foyer_revenu_mensuel_montant,\n        [REVENU_FISCAL1_FOYER]              as foyer_revenu_fiscal_1_montant,\n        [REVENU_FISCAL2_FOYER]              as foyer_revenu_fiscal_2_montant,\n        [CATEG_LOGEMENT_ACTUEL]             as logement_actuel_categorie_cle,\n        [TYPE_LOGEMENT_ACTUEL]              as logement_actuel_piece_nombre_cle,\n        [MODE_LOGEMENT_ACTUEL]              as logement_actuel_mode_logement_cle,\n        [COMMUNE_LOG_ACTUEL]                as logement_actuel_commune_cle,\n        [ZONAGEPLAFRESS_ACTUEL]             as logement_actuel_zone_plafond_ressource_cle,\n        [CATEG_LOGEMENT_RECHERCHE]          as logement_recherche_categorie_cle,\n        [TYPE_LOGEMENT_RECHERCHE]           as logement_recherche_piece_nombre_cle,\n        [COMMUNE_LOG_RECHERCHE]             as logement_recherche_commune_cle,\n        [ZONAGEPLAFRESS_RECHERCHE]          as logement_recherche_zone_plafond_ressource_cle,\n        [MT_APL_MENSUEL]                    as apl_mensuel_montant,\n        [MODE_MUTATION]                     as mutation_flag,\n        [ESTANRU]                           as anru_flag,\n        [VERSION_CERFA]                     as cerfa_version_code,\n        [NB_PHANDICAP_AUTONOMIE]            as handicape_nombre,\n        ---- RADIATION\n        [DATE_RADIATION]                    as radiation_date,\n        [MOTIF_RADIATION]                   as radiation_motif_cle,\n        [TYPE_LOGEMENT_ATTRIB]              as logement_attribue_piece_nombre_cle,\n        [COMMUNE_LOGEMENT_ATTRIB]           as logement_attribue_commune_cle,\n        [ZONAGEPLAFRESS_ATTRIB]             as logement_attribue_zone_plafond_ressource_cle,\n        [TYPE_RESERVATAIRE]                 as reservataire_type_cle,\n        [DELAI_ATTRIBUTION]                 as attribution_delai_jour_nombre,\n        [SIREN_RADIATION]                   as radiation_siren_numero,\n        [NUMERORPLS]                        as logement_rpls_id,\n        [NB_QPV]                            as qpv_flag  \n\n \n         \n    from \"wh_dp_bronze\".\"raw\".\"raw_gipsne_radiation\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_radiation as \n (\n    select\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_et_radiation_sne_millesime is null \n          or demande_et_radiation_sne_millesime in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_et_radiation_sne_millesime as integer) is not null \n        then cast(demande_et_radiation_sne_millesime as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_et_radiation_sne_millesime as float) is not null \n        then cast(cast(demande_et_radiation_sne_millesime as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n            \n                                as demande_et_radiation_sne_millesime\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demande_et_radiation_sne_millesime is null or trim(demande_et_radiation_sne_millesime) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demande_et_radiation_sne_millesime)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            when len(trim(demande_et_radiation_sne_millesime)) != 4 then CAST(NULL AS DATE)\n            else TRY_CAST(demande_et_radiation_sne_millesime + '-01-01' AS DATE)\n        \n        -- AUTO-D\u00c9TECTION pour les vraies dates\n        \n    end\n        \n                                as demande_et_radiation_sne_millesime_date\n        , demande_numero\n        , demande_id\n        , demandeur_type_code\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demande_creation_date is null or trim(demande_creation_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demande_creation_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(demande_creation_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(demande_creation_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(demande_creation_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(demande_creation_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as demande_creation_date\n        , demande_motif_premier_cle\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demandeur_naissance_date is null or trim(demandeur_naissance_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demandeur_naissance_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(demandeur_naissance_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(demandeur_naissance_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(demandeur_naissance_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(demandeur_naissance_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as demandeur_naissance_date\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_age is null \n          or demandeur_age in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_age as integer) is not null \n        then cast(demandeur_age as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_age as float) is not null \n        then cast(cast(demandeur_age as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as demandeur_age\n        , demandeur_sexe_cle\n        , demandeur_statut_professionnel_cle\n        , demandeur_nationalite_cle\n        , demandeur_situation_familiale_cle\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when foyer_taille is null \n          or foyer_taille in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(foyer_taille as integer) is not null \n        then cast(foyer_taille as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(foyer_taille as float) is not null \n        then cast(cast(foyer_taille as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as foyer_taille\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when cotitulaire_nombre is null \n          or cotitulaire_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(cotitulaire_nombre as integer) is not null \n        then cast(cotitulaire_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(cotitulaire_nombre as float) is not null \n        then cast(cast(cotitulaire_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as cotitulaire_nombre \n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when personne_a_charge_nombre is null \n          or personne_a_charge_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(personne_a_charge_nombre as integer) is not null \n        then cast(personne_a_charge_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(personne_a_charge_nombre as float) is not null \n        then cast(cast(personne_a_charge_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as personne_a_charge_nombre  \n        , demandeur_composition_familiale_code\n        , \n  \n  case\n    when try_cast(trim(replace(unite_de_consommation_nombre, ',', '.')) as float) is not null\n      then cast(trim(replace(unite_de_consommation_nombre, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as unite_de_consommation_nombre \n        , \n  \n  case\n    when try_cast(trim(replace(demandeur_revenu_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(demandeur_revenu_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as demandeur_revenu_mensuel_montant\n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_mensuel_montant \n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_fiscal_1_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_fiscal_1_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_fiscal_1_montant \n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_fiscal_2_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_fiscal_2_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_fiscal_2_montant  \n        , logement_actuel_categorie_cle\n        , logement_actuel_piece_nombre_cle\n        , logement_actuel_mode_logement_cle\n        , logement_actuel_commune_cle\n        , logement_actuel_zone_plafond_ressource_cle\n        , logement_recherche_categorie_cle\n        , logement_recherche_piece_nombre_cle\n        , logement_recherche_commune_cle\n        , logement_recherche_zone_plafond_ressource_cle\n        , \n  \n  case\n    when try_cast(trim(replace(apl_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(apl_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as apl_mensuel_montant \n        , \n  \n  case\n    when lower(trim(mutation_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as mutation_flag  \n        , \n  \n  case\n    when lower(trim(anru_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as anru_flag \n        , cerfa_version_code\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when handicape_nombre is null \n          or handicape_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(handicape_nombre as integer) is not null \n        then cast(handicape_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(handicape_nombre as float) is not null \n        then cast(cast(handicape_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as handicape_nombre \n        -------- RADIATION\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when radiation_date is null or trim(radiation_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(radiation_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(radiation_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(radiation_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(radiation_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(radiation_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as radiation_date\n        , radiation_motif_cle\n        , logement_attribue_piece_nombre_cle\n        , logement_attribue_commune_cle\n        , logement_attribue_zone_plafond_ressource_cle\n        , reservataire_type_cle\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when attribution_delai_jour_nombre is null \n          or attribution_delai_jour_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(attribution_delai_jour_nombre as integer) is not null \n        then cast(attribution_delai_jour_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(attribution_delai_jour_nombre as float) is not null \n        then cast(cast(attribution_delai_jour_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as attribution_delai_jour_nombre\n        , radiation_siren_numero\n        , logement_rpls_id\n        , \n  \n  case\n    when lower(trim(qpv_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as qpv_flag     \n    \n\n    from cte_rename_raw_gipsne_radiation\n ),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_radiation\n)\n\n \nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_radiation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:11.046988Z", "completed_at": "2025-12-10T16:26:11.108932Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:11.109390Z", "completed_at": "2025-12-10T16:26:12.651077Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6054315567016602, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_categ_logement", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_CATEG_LOGEMENT as categorie_logement_cle,\n    \n\n    \n    \n        CODE_CATEG_LOGEMENT as categorie_logement_code,\n    \n\n \n    [ORDRE] as categorie_logement_ordre_affichage,\n    [LIBL_CATEG_LOGEMENT] as categorie_logement_libelle_long,\n    [LIBC_CATEG_LOGEMENT] as categorie_logement_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_categ_logement\"\n),\n\ncte_cast as (\nselect\n    categorie_logement_cle,\n    categorie_logement_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when categorie_logement_ordre_affichage is null \n          or categorie_logement_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(categorie_logement_ordre_affichage as integer) is not null \n        then cast(categorie_logement_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(categorie_logement_ordre_affichage as float) is not null \n        then cast(cast(categorie_logement_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as categorie_logement_ordre_affichage,\n    categorie_logement_libelle_long,\n    categorie_logement_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_categ_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:12.654691Z", "completed_at": "2025-12-10T16:26:12.706139Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:12.706513Z", "completed_at": "2025-12-10T16:26:14.396282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7426669597625732, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_categ_logement_rech", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_CATEG_LOGEMENT as categorie_logement_cle,\n    \n\n    \n    \n        CODE_CATEG_LOGEMENT as categorie_logement_code,\n    \n\n \n    [ORDRE] as categorie_logement_ordre_affichage,\n    [LIBL_CATEG_LOGEMENT] as categorie_logement_libelle_long,\n    [LIBC_CATEG_LOGEMENT] as categorie_logement_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_categ_logement_rech\"\n),\n\ncte_cast as (\nselect\n    categorie_logement_cle,\n    categorie_logement_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when categorie_logement_ordre_affichage is null \n          or categorie_logement_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(categorie_logement_ordre_affichage as integer) is not null \n        then cast(categorie_logement_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(categorie_logement_ordre_affichage as float) is not null \n        then cast(cast(categorie_logement_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as categorie_logement_ordre_affichage,\n    categorie_logement_libelle_long,\n    categorie_logement_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_categ_logement_rech\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:14.399832Z", "completed_at": "2025-12-10T16:26:14.473059Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:14.473473Z", "completed_at": "2025-12-10T16:26:15.971958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.57326078414917, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_composition_famille", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_COMPOSITION_FAMILLE as composition_familiale_cle,\n    \n\n    \n    \n        cast(NULL as VARCHAR(8000)) as composition_familiale_code,\n    \n\n \n    [ORDRE] as composition_familiale_ordre_affichage,\n    [LIBL_COMPOSITION_FAMILLE] as composition_familiale_libelle_long,\n    [LIBC_COMPOSITION_FAMILLE] as composition_familiale_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_composition_famille\"\n),\n\ncte_cast as (\nselect\n    composition_familiale_cle,\n    composition_familiale_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when composition_familiale_ordre_affichage is null \n          or composition_familiale_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(composition_familiale_ordre_affichage as integer) is not null \n        then cast(composition_familiale_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(composition_familiale_ordre_affichage as float) is not null \n        then cast(cast(composition_familiale_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as composition_familiale_ordre_affichage,\n    composition_familiale_libelle_long,\n    composition_familiale_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_composition_famille\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:15.976715Z", "completed_at": "2025-12-10T16:26:15.982289Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:15.982867Z", "completed_at": "2025-12-10T16:26:17.862461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.887308120727539, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_geographie", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_ref_geographie\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_ref_geographie\n * Cible :          stg_gipsne_ref_geographie\n *test\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_ref_geographie as \n (\n    select \n        [CLE_COMMUNE]           as geographie_sne_commune_cle,\n\t    [CODE_COMMUNE]          as geographie_sne_commune_code,\n\t\t[LIBL_COMMUNE]          as geographie_sne_commune_libelle,\n\t\t[_meta_year]            as geographie_sne_annee\n\n    from   \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_geographie\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_ref_geographie as \n (\n    select\n        geographie_sne_commune_cle,\n        geographie_sne_commune_code,\n        geographie_sne_commune_libelle,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when geographie_sne_annee is null \n          or geographie_sne_annee in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(geographie_sne_annee as integer) is not null \n        then cast(geographie_sne_annee as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(geographie_sne_annee as float) is not null \n        then cast(cast(geographie_sne_annee as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n  \n                    as geographie_sne_annee\n       \n    from  cte_rename_raw_gipsne_ref_geographie\n ),\n \n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_ref_geographie\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_geographie\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:17.866261Z", "completed_at": "2025-12-10T16:26:17.911578Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:17.912006Z", "completed_at": "2025-12-10T16:26:19.514574Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6493330001831055, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_lien_demandeur", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_LIEN_DEMANDEUR as demandeur_lien_cle,\n    \n\n    \n    \n        CODE_LIEN_DEMANDEUR as demandeur_lien_code,\n    \n\n \n    [ORDRE] as demandeur_lien_ordre_affichage,\n    [LIBL_LIEN_DEMANDEUR] as demandeur_lien_libelle_long,\n    [LIBC_LIEN_DEMANDEUR] as demandeur_lien_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_lien_demandeur\"\n),\n\ncte_cast as (\nselect\n    demandeur_lien_cle,\n    demandeur_lien_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_lien_ordre_affichage is null \n          or demandeur_lien_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_lien_ordre_affichage as integer) is not null \n        then cast(demandeur_lien_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_lien_ordre_affichage as float) is not null \n        then cast(cast(demandeur_lien_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as demandeur_lien_ordre_affichage,\n    demandeur_lien_libelle_long,\n    demandeur_lien_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_lien_demandeur\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:19.520372Z", "completed_at": "2025-12-10T16:26:19.562285Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:19.562690Z", "completed_at": "2025-12-10T16:26:21.117000Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5988194942474365, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_mode_logement", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_MODE_LOGEMENT as mode_logement_cle,\n    \n\n    \n    \n        CODE_MODE_LOGEMENT as mode_logement_code,\n    \n\n \n    [ORDRE] as mode_logement_ordre_affichage,\n    [LIBL_MODE_LOGEMENT] as mode_logement_libelle_long,\n    [LIBC_MODE_LOGEMENT] as mode_logement_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_mode_logement\"\n),\n\ncte_cast as (\nselect\n    mode_logement_cle,\n    mode_logement_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when mode_logement_ordre_affichage is null \n          or mode_logement_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(mode_logement_ordre_affichage as integer) is not null \n        then cast(mode_logement_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(mode_logement_ordre_affichage as float) is not null \n        then cast(cast(mode_logement_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as mode_logement_ordre_affichage,\n    mode_logement_libelle_long,\n    mode_logement_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_mode_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:21.120790Z", "completed_at": "2025-12-10T16:26:21.170975Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:21.171563Z", "completed_at": "2025-12-10T16:26:22.747403Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6276917457580566, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_motif_demande", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_MOTIF_DEMANDE as demande_motif_cle,\n    \n\n    \n    \n        CODE_MOTIF_DEMANDE as demande_motif_code,\n    \n\n \n    [ORDRE] as demande_motif_ordre_affichage,\n    [LIBL_MOTIF_DEMANDE] as demande_motif_libelle_long,\n    [LIBC_MOTIF_DEMANDE] as demande_motif_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_motif_demande\"\n),\n\ncte_cast as (\nselect\n    demande_motif_cle,\n    demande_motif_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_motif_ordre_affichage is null \n          or demande_motif_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_motif_ordre_affichage as integer) is not null \n        then cast(demande_motif_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_motif_ordre_affichage as float) is not null \n        then cast(cast(demande_motif_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as demande_motif_ordre_affichage,\n    demande_motif_libelle_long,\n    demande_motif_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_motif_demande\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:22.752815Z", "completed_at": "2025-12-10T16:26:22.797367Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:22.798122Z", "completed_at": "2025-12-10T16:26:24.246643Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.495650053024292, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_motif_radiation", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_MOTIF_RADIATION as radiation_motif_cle,\n    \n\n    \n    \n        CODE_MOTIF_RADIATION as radiation_motif_code,\n    \n\n \n    [ORDRE] as radiation_motif_ordre_affichage,\n    [LIBL_MOTIF_RADIATION] as radiation_motif_libelle_long,\n    [LIBC_MOTIF_RADIATION] as radiation_motif_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_motif_radiation\"\n),\n\ncte_cast as (\nselect\n    radiation_motif_cle,\n    radiation_motif_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when radiation_motif_ordre_affichage is null \n          or radiation_motif_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(radiation_motif_ordre_affichage as integer) is not null \n        then cast(radiation_motif_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(radiation_motif_ordre_affichage as float) is not null \n        then cast(cast(radiation_motif_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as radiation_motif_ordre_affichage,\n    radiation_motif_libelle_long,\n    radiation_motif_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_motif_radiation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:24.249566Z", "completed_at": "2025-12-10T16:26:24.291363Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:24.291715Z", "completed_at": "2025-12-10T16:26:25.723768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4752497673034668, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_situation_familiale", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_SITUATION_FAMILIALE as situation_familiale_cle,\n    \n\n    \n    \n        CODE_SITUATION_FAMILIALE as situation_familiale_code,\n    \n\n \n    [ORDRE] as situation_familiale_ordre_affichage,\n    [LIBL_SITUATION_FAMILIALE] as situation_familiale_libelle_long,\n    [LIBC_SITUATION_FAMILIALE] as situation_familiale_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_situation_familiale\"\n),\n\ncte_cast as (\nselect\n    situation_familiale_cle,\n    situation_familiale_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when situation_familiale_ordre_affichage is null \n          or situation_familiale_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(situation_familiale_ordre_affichage as integer) is not null \n        then cast(situation_familiale_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(situation_familiale_ordre_affichage as float) is not null \n        then cast(cast(situation_familiale_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as situation_familiale_ordre_affichage,\n    situation_familiale_libelle_long,\n    situation_familiale_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_situation_familiale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:25.728695Z", "completed_at": "2025-12-10T16:26:25.769987Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:25.770410Z", "completed_at": "2025-12-10T16:26:27.191819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4644997119903564, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_statut_dalo", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_STATUT_DALO as dalo_statut_cle,\n    \n\n    \n    \n        CODE_STATUT_DALO as dalo_statut_code,\n    \n\n \n    [ORDRE] as dalo_statut_ordre_affichage,\n    [LIBL_STATUT_DALO] as dalo_statut_libelle_long,\n    [LIBC_STATUT_DALO] as dalo_statut_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_statut_dalo\"\n),\n\ncte_cast as (\nselect\n    dalo_statut_cle,\n    dalo_statut_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when dalo_statut_ordre_affichage is null \n          or dalo_statut_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(dalo_statut_ordre_affichage as integer) is not null \n        then cast(dalo_statut_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(dalo_statut_ordre_affichage as float) is not null \n        then cast(cast(dalo_statut_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as dalo_statut_ordre_affichage,\n    dalo_statut_libelle_long,\n    dalo_statut_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_dalo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:27.195027Z", "completed_at": "2025-12-10T16:26:27.236295Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:27.236741Z", "completed_at": "2025-12-10T16:26:28.791721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5977811813354492, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_statut_professionnel", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_STATUT_PROFESSIONNEL as statut_professionnel_cle,\n    \n\n    \n    \n        CODE_STATUT_PROFESSIONNEL as statut_professionnel_code,\n    \n\n \n    [ORDRE] as statut_professionnel_ordre_affichage,\n    [LIBL_STATUT_PROFESSIONNEL] as statut_professionnel_libelle_long,\n    [LIBC_STATUT_PROFESSIONNEL] as statut_professionnel_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_statut_professionnel\"\n),\n\ncte_cast as (\nselect\n    statut_professionnel_cle,\n    statut_professionnel_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when statut_professionnel_ordre_affichage is null \n          or statut_professionnel_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(statut_professionnel_ordre_affichage as integer) is not null \n        then cast(statut_professionnel_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(statut_professionnel_ordre_affichage as float) is not null \n        then cast(cast(statut_professionnel_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as statut_professionnel_ordre_affichage,\n    statut_professionnel_libelle_long,\n    statut_professionnel_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_professionnel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:28.796496Z", "completed_at": "2025-12-10T16:26:28.848612Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:28.848976Z", "completed_at": "2025-12-10T16:26:30.939451Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.14436674118042, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_type_logement", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_TYPE_LOGEMENT as piece_nombre_sne_cle,\n    \n\n    \n    \n        CODE_TYPE_LOGEMENT as piece_nombre_sne_code,\n    \n\n \n    [ORDRE] as piece_nombre_sne_ordre_affichage,\n    [LIBL_TYPE_LOGEMENT] as piece_nombre_sne_libelle_long,\n    [LIBC_TYPE_LOGEMENT] as piece_nombre_sne_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_type_logement\"\n),\n\ncte_cast as (\nselect\n    piece_nombre_sne_cle,\n    piece_nombre_sne_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when piece_nombre_sne_ordre_affichage is null \n          or piece_nombre_sne_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(piece_nombre_sne_ordre_affichage as integer) is not null \n        then cast(piece_nombre_sne_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(piece_nombre_sne_ordre_affichage as float) is not null \n        then cast(cast(piece_nombre_sne_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as piece_nombre_sne_ordre_affichage,\n    piece_nombre_sne_libelle_long,\n    piece_nombre_sne_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:30.943706Z", "completed_at": "2025-12-10T16:26:30.991436Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:30.991754Z", "completed_at": "2025-12-10T16:26:32.451645Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5098588466644287, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_type_personne", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_TYPE_PERSONNE as demandeur_type_cle,\n    \n\n    \n    \n        cast(NULL as VARCHAR(8000)) as demandeur_type_code,\n    \n\n \n    [ORDRE] as demandeur_type_ordre_affichage,\n    [LIBL_TYPE_PERSONNE] as demandeur_type_libelle_long,\n    [LIBC_TYPE_PERSONNE] as demandeur_type_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_type_personne\"\n),\n\ncte_cast as (\nselect\n    demandeur_type_cle,\n    demandeur_type_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_type_ordre_affichage is null \n          or demandeur_type_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_type_ordre_affichage as integer) is not null \n        then cast(demandeur_type_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_type_ordre_affichage as float) is not null \n        then cast(cast(demandeur_type_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as demandeur_type_ordre_affichage,\n    demandeur_type_libelle_long,\n    demandeur_type_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_personne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:32.458086Z", "completed_at": "2025-12-10T16:26:32.499762Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:32.500189Z", "completed_at": "2025-12-10T16:26:34.007050Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5504887104034424, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_type_reservataire", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_TYPE_RESERVATAIRE as reservataire_type_cle,\n    \n\n    \n    \n        CODE_TYPE_RESERVATAIRE as reservataire_type_code,\n    \n\n \n    [ORDRE] as reservataire_type_ordre_affichage,\n    [LIBL_TYPE_RESERVATAIRE] as reservataire_type_libelle_long,\n    [LIBC_TYPE_RESERVATAIRE] as reservataire_type_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_type_reservataire\"\n),\n\ncte_cast as (\nselect\n    reservataire_type_cle,\n    reservataire_type_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when reservataire_type_ordre_affichage is null \n          or reservataire_type_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(reservataire_type_ordre_affichage as integer) is not null \n        then cast(reservataire_type_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(reservataire_type_ordre_affichage as float) is not null \n        then cast(cast(reservataire_type_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as reservataire_type_ordre_affichage,\n    reservataire_type_libelle_long,\n    reservataire_type_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_reservataire\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:34.010357Z", "completed_at": "2025-12-10T16:26:34.055091Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:34.055640Z", "completed_at": "2025-12-10T16:26:35.491797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4827847480773926, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_ref_zonage_plaf", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith cte_rename as (\n    select\n    \n    \n        CLE_ZONAGE_PLAF as zone_plafond_ressource_cle,\n    \n\n    \n    \n        CODE_ZONAGE_PLAF as zone_plafond_ressource_code,\n    \n\n \n    [ORDRE] as zone_plafond_ressource_ordre_affichage,\n    [LIBL_ZONAGE_PLAF] as zone_plafond_ressource_libelle_long,\n    [LIBC_ZONAGE_PLAF] as zone_plafond_ressource_libelle_court\nfrom \n    \"wh_dp_bronze\".\"raw\".\"raw_gipsne_ref_zonage_plaf\"\n),\n\ncte_cast as (\nselect\n    zone_plafond_ressource_cle,\n    zone_plafond_ressource_code,\n    \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when zone_plafond_ressource_ordre_affichage is null \n          or zone_plafond_ressource_ordre_affichage in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(zone_plafond_ressource_ordre_affichage as integer) is not null \n        then cast(zone_plafond_ressource_ordre_affichage as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(zone_plafond_ressource_ordre_affichage as float) is not null \n        then cast(cast(zone_plafond_ressource_ordre_affichage as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as zone_plafond_ressource_ordre_affichage,\n    zone_plafond_ressource_libelle_long,\n    zone_plafond_ressource_libelle_court\nfrom cte_rename\n),\n\ncte_finale as (\nselect\n    *,\n    \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\nfrom cte_cast\n)\n\nselect * from cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_zonage_plaf\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:26:35.497728Z", "completed_at": "2025-12-10T16:26:35.505279Z"}, {"name": "execute", "started_at": "2025-12-10T16:26:35.506231Z", "completed_at": "2025-12-10T16:27:43.828524Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 68.33245897293091, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.stg_gipsne_stock", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table staging stg_gipsne_stock\n *                  Renommage, nettoyage, typage\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          raw_gipsne_stock\n * Cible :          stg_gipsne_stock\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--******************* RENOMMAGE DES COLONNES **********************\n-------------------------------------------------------------------\n cte_rename_raw_gipsne_stock as \n (\n    select \n        [_meta_year]                        as demande_et_radiation_sne_millesime,\n        [DEMANDE]                           as demande_id ,\n        [NUMERO_UNIQUE]                     as demande_numero ,\n        [TYPE_DEMANDEUR]                    as demandeur_type_code,\n        [DATE_CREATION]                     as demande_creation_date,\n        [MOTIF_DEMANDE]                     as demande_motif_premier_cle,\n        [DATE_NAISS_DEMANDEUR]              as demandeur_naissance_date,\n        [AGE_DEMANDEUR_DEMANDE]             as demandeur_age,\n        [SEXE_DEMANDEUR]                    as demandeur_sexe_cle,\n        [STATUT_PROF_DEMANDEUR]             as demandeur_statut_professionnel_cle,\n        [NATIONALITE_DEMANDEUR]             as demandeur_nationalite_cle,\n        [SITU_FAMILIALE_DEMANDEUR]          as demandeur_situation_familiale_cle,\n        [TAILLE_MENAGE]                     as foyer_taille,\n        [COTITULAIRE]                       as cotitulaire_nombre,\n        [PERSONNE_A_CHARGE]                 as personne_a_charge_nombre,\n        [COMPOSITION_FAMILLE]               as demandeur_composition_familiale_code,\n        [UNITE_CONSO]                       as unite_de_consommation_nombre,\n        [REVENU_DEMANDEUR]                  as demandeur_revenu_mensuel_montant,\n        [REVENU_MENSUEL_FOYER]              as foyer_revenu_mensuel_montant,\n        [REVENU_FISCAL1_FOYER]              as foyer_revenu_fiscal_1_montant,\n        [REVENU_FISCAL2_FOYER]              as foyer_revenu_fiscal_2_montant,\n        [CATEG_LOGEMENT_ACTUEL]             as logement_actuel_categorie_cle,\n        [TYPE_LOGEMENT_ACTUEL]              as logement_actuel_piece_nombre_cle,\n        [MODE_LOGEMENT_ACTUEL]              as logement_actuel_mode_logement_cle,\n        [COMMUNE_LOG_ACTUEL]                as logement_actuel_commune_cle,\n        [ZONAGEPLAFRESS_ACTUEL]             as logement_actuel_zone_plafond_ressource_cle,\n        [CATEG_LOGEMENT_RECHERCHE]          as logement_recherche_categorie_cle,\n        [TYPE_LOGEMENT_RECHERCHE]           as logement_recherche_piece_nombre_cle,\n        [COMMUNE_LOG_RECHERCHE]             as logement_recherche_commune_cle,\n        [ZONAGEPLAFRESS_RECHERCHE]          as logement_recherche_zone_plafond_ressource_cle,\n        [MT_APL_MENSUEL]                    as apl_mensuel_montant,\n        [MODE_MUTATION]                     as mutation_flag,\n        [ESTANRU]                           as anru_flag,\n        [VERSION_CERFA]                     as cerfa_version_code,\n        [NB_PHANDICAP_AUTONOMIE]            as handicape_nombre,\n        ---- RADIATION\n        [DATE_RADIATION]                    as radiation_date,\n        [MOTIF_RADIATION]                   as radiation_motif_cle,\n        [TYPE_LOGEMENT_ATTRIB]              as logement_attribue_piece_nombre_cle,\n        [COMMUNE_LOGEMENT_ATTRIB]           as logement_attribue_commune_cle,\n        [ZONAGEPLAFRESS_ATTRIB]             as logement_attribue_zone_plafond_ressource_cle,\n        [TYPE_RESERVATAIRE]                 as reservataire_type_cle,\n        [DELAI_ATTRIBUTION]                 as attribution_delai_jour_nombre,\n        [SIREN_RADIATION]                   as radiation_siren_numero,\n        [NUMERORPLS]                        as logement_rpls_id,\n        [NB_QPV]                            as qpv_flag  \n\n \n         \n    from \"wh_dp_bronze\".\"raw\".\"raw_gipsne_stock\"\n ),\n\n-------------------------------------------------------------------\n--************* NETTOYAGE ET TYPAGE DES COLONNES ******************\n-------------------------------------------------------------------\ncte_clean_and_type_raw_gipsne_stock as \n (\n    select\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demande_et_radiation_sne_millesime is null \n          or demande_et_radiation_sne_millesime in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demande_et_radiation_sne_millesime as integer) is not null \n        then cast(demande_et_radiation_sne_millesime as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demande_et_radiation_sne_millesime as float) is not null \n        then cast(cast(demande_et_radiation_sne_millesime as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n            \n                                as demande_et_radiation_sne_millesime\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demande_et_radiation_sne_millesime is null or trim(demande_et_radiation_sne_millesime) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demande_et_radiation_sne_millesime)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            when len(trim(demande_et_radiation_sne_millesime)) != 4 then CAST(NULL AS DATE)\n            else TRY_CAST(demande_et_radiation_sne_millesime + '-01-01' AS DATE)\n        \n        -- AUTO-D\u00c9TECTION pour les vraies dates\n        \n    end\n        \n                                as demande_et_radiation_sne_millesime_date\n        , demande_numero\n        , demande_id\n        , demandeur_type_code\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demande_creation_date is null or trim(demande_creation_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demande_creation_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(demande_creation_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(demande_creation_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(demande_creation_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(demande_creation_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(demande_creation_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as demande_creation_date\n        , demande_motif_premier_cle\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when demandeur_naissance_date is null or trim(demandeur_naissance_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(demandeur_naissance_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(demandeur_naissance_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(demandeur_naissance_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(demandeur_naissance_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(demandeur_naissance_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(demandeur_naissance_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as demandeur_naissance_date\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when demandeur_age is null \n          or demandeur_age in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(demandeur_age as integer) is not null \n        then cast(demandeur_age as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(demandeur_age as float) is not null \n        then cast(cast(demandeur_age as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as demandeur_age\n        , demandeur_sexe_cle\n        , demandeur_statut_professionnel_cle\n        , demandeur_nationalite_cle\n        , demandeur_situation_familiale_cle\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when foyer_taille is null \n          or foyer_taille in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(foyer_taille as integer) is not null \n        then cast(foyer_taille as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(foyer_taille as float) is not null \n        then cast(cast(foyer_taille as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as foyer_taille\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when cotitulaire_nombre is null \n          or cotitulaire_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(cotitulaire_nombre as integer) is not null \n        then cast(cotitulaire_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(cotitulaire_nombre as float) is not null \n        then cast(cast(cotitulaire_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as cotitulaire_nombre \n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when personne_a_charge_nombre is null \n          or personne_a_charge_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(personne_a_charge_nombre as integer) is not null \n        then cast(personne_a_charge_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(personne_a_charge_nombre as float) is not null \n        then cast(cast(personne_a_charge_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as personne_a_charge_nombre  \n        , demandeur_composition_familiale_code\n        , \n  \n  case\n    when try_cast(trim(replace(unite_de_consommation_nombre, ',', '.')) as float) is not null\n      then cast(trim(replace(unite_de_consommation_nombre, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as unite_de_consommation_nombre \n        , \n  \n  case\n    when try_cast(trim(replace(demandeur_revenu_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(demandeur_revenu_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as demandeur_revenu_mensuel_montant\n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_mensuel_montant \n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_fiscal_1_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_fiscal_1_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_fiscal_1_montant \n        , \n  \n  case\n    when try_cast(trim(replace(foyer_revenu_fiscal_2_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(foyer_revenu_fiscal_2_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as foyer_revenu_fiscal_2_montant  \n        , logement_actuel_categorie_cle\n        , logement_actuel_piece_nombre_cle\n        , logement_actuel_mode_logement_cle\n        , logement_actuel_commune_cle\n        , logement_actuel_zone_plafond_ressource_cle\n        , logement_recherche_categorie_cle\n        , logement_recherche_piece_nombre_cle\n        , logement_recherche_commune_cle\n        , logement_recherche_zone_plafond_ressource_cle\n        , \n  \n  case\n    when try_cast(trim(replace(apl_mensuel_montant, ',', '.')) as float) is not null\n      then cast(trim(replace(apl_mensuel_montant, ',', '.')) as float)\n    else  CAST(0 as FLOAT)\n  end\n \n                                as apl_mensuel_montant \n        , \n  \n  case\n    when lower(trim(mutation_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as mutation_flag  \n        , \n  \n  case\n    when lower(trim(anru_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as anru_flag \n        , cerfa_version_code\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when handicape_nombre is null \n          or handicape_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(handicape_nombre as integer) is not null \n        then cast(handicape_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(handicape_nombre as float) is not null \n        then cast(cast(handicape_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as handicape_nombre \n        -------- RADIATION\n        , \n    case\n        -- Gestion des valeurs nulles ou vides\n        when radiation_date is null or trim(radiation_date) = '' then CAST(NULL AS DATE)\n        \n        -- Gestion des valeurs 'NA' (Not Available)\n        when upper(trim(radiation_date)) in ('NA', 'NA/NA') then CAST(NULL AS DATE)\n\n        -- Format MM/AAAA (ex: 05/1981)\n        -- Convertit en AAAA-MM-01 (1er du mois par d\u00e9faut)\n        \n            -- D\u00e9tection automatique du format bas\u00e9e sur la structure de la cha\u00eene\n            when len(trim(radiation_date)) < 10 then CAST(NULL AS DATE)\n            \n            -- Si la cha\u00eene contient un tiret en position 5 (AAAA-MM-JJ ou AAAA-MM-JJ HH:MI:SS)\n            when SUBSTRING(trim(radiation_date), 5, 1) = '-' then \n                TRY_CAST(LEFT(trim(radiation_date), 10) AS DATE)\n            \n            -- Si la cha\u00eene contient un s\u00e9parateur (/ ou -) en position 3 (JJ/MM/AAAA ou JJ-MM-AAAA)\n            when SUBSTRING(trim(radiation_date), 3, 1) in ('/', '-') then \n                TRY_CAST(\n                    CONCAT(\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 7, 4), '-',  -- Ann\u00e9e\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 4, 2), '-',  -- Mois\n                        SUBSTRING(trim(REPLACE(radiation_date, '/', '-')), 1, 2)        -- Jour\n                    ) AS DATE\n                )\n            \n            -- Fallback : valeur par d\u00e9faut si aucun format d\u00e9tect\u00e9\n            else CAST(NULL AS DATE)\n        \n    end\n  \n                                as radiation_date\n        , radiation_motif_cle\n        , logement_attribue_piece_nombre_cle\n        , logement_attribue_commune_cle\n        , logement_attribue_zone_plafond_ressource_cle\n        , reservataire_type_cle\n        , \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when attribution_delai_jour_nombre is null \n          or attribution_delai_jour_nombre in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(attribution_delai_jour_nombre as integer) is not null \n        then cast(attribution_delai_jour_nombre as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(attribution_delai_jour_nombre as float) is not null \n        then cast(cast(attribution_delai_jour_nombre as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n \n                                as attribution_delai_jour_nombre\n        , radiation_siren_numero\n        , logement_rpls_id\n        , \n  \n  case\n    when lower(trim(qpv_flag)) in ('1','oui','vrai','active','true','yes') then cast(1 as bit)\n    else cast(0 as bit)\n  end\n \n                                as qpv_flag     \n    \n\n    from cte_rename_raw_gipsne_stock\n ),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\ncte_finale as\n(\n    select \n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n\n    from cte_clean_and_type_raw_gipsne_stock\n)\n\n \nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"stg\".\"stg_gipsne_stock\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:27:44.331154Z", "completed_at": "2025-12-10T16:27:44.338165Z"}, {"name": "execute", "started_at": "2025-12-10T16:27:44.339218Z", "completed_at": "2025-12-10T16:27:47.569095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.23933744430542, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_categorie_logement", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_categorie_logement\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          stg_gipsne_ref_categ_logement\n                    stg_gipsne_ref_categ_logement_rech\n * Cible :          int_categorie_logement\n \n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_stg_gipsne_ref_categ_logement_rech as \n(\n    select \n        categorie_logement_cle,\n        categorie_logement_code,\n        categorie_logement_ordre_affichage,\n        categorie_logement_libelle_long,\n        categorie_logement_libelle_court\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_categ_logement_rech\"\n),\n\ncte_stg_gipsne_ref_categ_logement as \n(\n    select \n        categorie_logement_cle,\n        categorie_logement_code,\n        categorie_logement_ordre_affichage,\n        categorie_logement_libelle_long,\n        categorie_logement_libelle_court\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_categ_logement\"\n),\n\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n--union des 2 tables\ncte_union_stg_gipsne_ref_categ_logement as\n(\n    select *\n    from cte_stg_gipsne_ref_categ_logement_rech\n    union\n    select *\n    from cte_stg_gipsne_ref_categ_logement\n),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc_stg_gipsne_ref_categ_logement as\n(\n    select\n        *\n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        cast(categorie_logement_code as varchar(max))\n    \n)  \n \n as categorie_logement_hk\n    from \n        cte_union_stg_gipsne_ref_categ_logement\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_gipsne_ref_categ_logement\n )\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_categorie_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:27:47.573666Z", "completed_at": "2025-12-10T16:27:47.582061Z"}, {"name": "execute", "started_at": "2025-12-10T16:27:47.582866Z", "completed_at": "2025-12-10T16:27:49.191407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.619100570678711, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_composition_familiale", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table composition_familiale\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_composition_famille\"\n * Cible :          composition_familiale\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        composition_familiale_cle,\n        composition_familiale_code,\n        composition_familiale_ordre_affichage,\n        composition_familiale_libelle_long,\n        composition_familiale_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_composition_famille\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as composition_familiale_cle,\n        'N/A'          as composition_familiale_code,\n        0                                       as composition_familiale_ordre_affichage,\n        'Non disponible'  as composition_familiale_libelle_long,\n        'Non disponible'  as composition_familiale_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        composition_familiale_cle,\n        coalesce(composition_familiale_code,composition_familiale_cle) as  composition_familiale_code,\n        composition_familiale_ordre_affichage,\n        composition_familiale_libelle_long,\n        composition_familiale_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(composition_familiale_code as varchar(max))\n    \n)  \n \n as composition_familiale_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_composition_familiale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:27:49.196030Z", "completed_at": "2025-12-10T16:27:49.206952Z"}, {"name": "execute", "started_at": "2025-12-10T16:27:49.207557Z", "completed_at": "2025-12-10T16:28:48.634226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 59.43954014778137, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demande_commune_recherche", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_demande_commune_recherche\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          stg_gipsne_ele_classement_commune     \n                    stg_gipsne_ref_geographie       \n                    int_arrondissement\n                    int_commune\n * Cible :          int_demande_commune_recherche\n \n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_stg_gipsne_ele_classement_commune as \n(\n    select \n        demande_commune_recherche_demande_id,\n\t\tdemande_commune_recherche_commune_cle,\n\t\tdemande_commune_recherche_annee,\n        demande_commune_recherche_ordre_priorite\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_classement_commune\"\n),\n\n \ncte_stg_gipsne_ref_geographie as\n(\n    select  \n        geographie_sne_commune_cle\n        , geographie_sne_commune_code\n        , geographie_sne_commune_libelle\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_geographie\"\n),\n\ncte_int_arrondissement as (\n    select arrondissement_code, arrondissement_annee, commune_code\n    from \"wh_dp_silver\".\"int\".\"int_arrondissement\"\n    where \n    case\n        when (arrondissement_annee) = (\n            select max((arrondissement_annee))\n            from int_arrondissement\n        ) then 1\n        else 0\n    end\n = 1\n),\n\ncte_int_commune as (\n    select commune_code, commune_annee \n    from \"wh_dp_silver\".\"int\".\"int_commune\"\n    where \n    case\n        when (commune_annee) = (\n            select max((commune_annee))\n            from int_commune\n        ) then 1\n        else 0\n    end\n = 1\n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n \ncte_calc_stg_gipsne_ele_classement_commune as\n(\n    select \n        stg.demande_commune_recherche_demande_id    as demande_id \n        , ref.geographie_sne_commune_code           as commune_code  \n        , stg.demande_commune_recherche_annee\n        , stg.demande_commune_recherche_ordre_priorite  \n        , \n    case\n        when (demande_commune_recherche_annee) = (\n            select max((demande_commune_recherche_annee))\n            from cte_stg_gipsne_ele_classement_commune\n        ) then 1\n        else 0\n    end\n\n                as demande_commune_recherche_annee_last_flag\n\n    from \n        cte_stg_gipsne_ele_classement_commune stg\n    left join\n        cte_stg_gipsne_ref_geographie ref\n        on stg.demande_commune_recherche_commune_cle = ref.geographie_sne_commune_cle\n    \n),\n\n-- dans la source, le commune code peut etre un arrondissement\ncte_classement_commune_avec_arrondissement as\n(\n    select\n        demande_id\n        , isnull(arrondissement.commune_code, ele.commune_code) as commune_code\n        , isnull(arrondissement.arrondissement_code,'N/A') as arrondissement_code\n        , ele.demande_commune_recherche_annee\n        , ele.demande_commune_recherche_ordre_priorite\n        , ele.demande_commune_recherche_annee_last_flag\n        , isnull(arrondissement.arrondissement_annee, commune.commune_annee) as commune_annee \n    \n    from \n        cte_calc_stg_gipsne_ele_classement_commune ele\n    --seulement pour recuperer la derniere annee de la commune\n    left join cte_int_commune commune\n        on (ele.commune_code = commune.commune_code)\n    --permet de savoir si le code commune source est un arrondissement\n    left join cte_int_arrondissement arrondissement\n        on (ele.commune_code = arrondissement.arrondissement_code)\n),\n\n--ajout des cl\u00e9s techniques et fonctionnels\ncte_hk_calc_stg_gipsne_ele_classement_commune as\n(\n    select\n        *\n        ,\n    \n        concat_ws('||', demande_commune_recherche_annee, demande_id, commune_code, demande_commune_recherche_ordre_priorite) \n    \n \n                            as demande_commune_recherche_bk  \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_commune_recherche_annee, demande_id, commune_code, demande_commune_recherche_ordre_priorite) \n    \n)  \n \n \n                            as demande_commune_recherche_hk  \n        ,\n    \n        concat_ws('||', commune_annee, commune_code) \n    \n \n                            as commune_bk\n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_annee, commune_code) \n    \n)  \n \n \n                            as commune_hk\n        ,\n    \n        concat_ws('||', commune_annee, arrondissement_code) \n    \n \n                            as arrondissement_bk\n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_annee, arrondissement_code) \n    \n)  \n \n \n                            as arrondissement_hk\n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_commune_recherche_annee, demande_id) \n    \n)  \n \n \n                            as demande_et_radiation_sne_hk\n        ,\n    \n        concat_ws('||', demande_commune_recherche_annee, demande_id) \n    \n \n                            as demande_et_radiation_sne_bk\n    from \n        cte_classement_commune_avec_arrondissement\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_gipsne_ele_classement_commune\n )\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demande_commune_recherche\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:48.637597Z", "completed_at": "2025-12-10T16:28:48.642947Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:48.643309Z", "completed_at": "2025-12-10T16:28:50.066860Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4301908016204834, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demandeur_lien", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table demandeur_lien\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_lien_demandeur\"\n * Cible :          demandeur_lien\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        demandeur_lien_cle,\n        demandeur_lien_code,\n        demandeur_lien_ordre_affichage,\n        demandeur_lien_libelle_long,\n        demandeur_lien_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_lien_demandeur\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as demandeur_lien_cle,\n        'N/A'          as demandeur_lien_code,\n        0                                       as demandeur_lien_ordre_affichage,\n        'Non disponible'  as demandeur_lien_libelle_long,\n        'Non disponible'  as demandeur_lien_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        demandeur_lien_cle,\n        coalesce(demandeur_lien_code,demandeur_lien_cle) as  demandeur_lien_code,\n        demandeur_lien_ordre_affichage,\n        demandeur_lien_libelle_long,\n        demandeur_lien_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_lien_code as varchar(max))\n    \n)  \n \n as demandeur_lien_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demandeur_lien\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:50.071369Z", "completed_at": "2025-12-10T16:28:50.075135Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:50.075529Z", "completed_at": "2025-12-10T16:28:51.591238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5212032794952393, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_mode_logement", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table mode_logement\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_mode_logement\"\n * Cible :          mode_logement\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        mode_logement_cle,\n        mode_logement_code,\n        mode_logement_ordre_affichage,\n        mode_logement_libelle_long,\n        mode_logement_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_mode_logement\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as mode_logement_cle,\n        'N/A'          as mode_logement_code,\n        0                                       as mode_logement_ordre_affichage,\n        'Non disponible'  as mode_logement_libelle_long,\n        'Non disponible'  as mode_logement_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        mode_logement_cle,\n        coalesce(mode_logement_code,mode_logement_cle) as  mode_logement_code,\n        mode_logement_ordre_affichage,\n        mode_logement_libelle_long,\n        mode_logement_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(mode_logement_code as varchar(max))\n    \n)  \n \n as mode_logement_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_mode_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:51.595897Z", "completed_at": "2025-12-10T16:28:51.601432Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:51.602046Z", "completed_at": "2025-12-10T16:28:53.035950Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.441563606262207, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demande_motif", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table demande_motif\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_motif_demande\"\n * Cible :          demande_motif\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        demande_motif_cle,\n        demande_motif_code,\n        demande_motif_ordre_affichage,\n        demande_motif_libelle_long,\n        demande_motif_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_motif_demande\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as demande_motif_cle,\n        'N/A'          as demande_motif_code,\n        0                                       as demande_motif_ordre_affichage,\n        'Non disponible'  as demande_motif_libelle_long,\n        'Non disponible'  as demande_motif_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        demande_motif_cle,\n        coalesce(demande_motif_code,demande_motif_cle) as  demande_motif_code,\n        demande_motif_ordre_affichage,\n        demande_motif_libelle_long,\n        demande_motif_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demande_motif_code as varchar(max))\n    \n)  \n \n as demande_motif_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demande_motif\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:53.042327Z", "completed_at": "2025-12-10T16:28:53.048184Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:53.048753Z", "completed_at": "2025-12-10T16:28:55.398851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3582541942596436, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_radiation_motif", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_radiation_motif\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          stg_gipsne_ref_motif_radiation             \n * Cible :          int_radiation_motif\n \n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_stg_gipsne_ref_motif_radiation as \n(\n    select \n        radiation_motif_cle,\n        radiation_motif_code,\n        radiation_motif_ordre_affichage,\n        radiation_motif_libelle_long,\n        radiation_motif_libelle_court\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_motif_radiation\"\n),\n\ncte_default_table as\n(\n    select \n        \n        'N/A'          as radiation_motif_cle,\n        'N/A'          as radiation_motif_code,\n        -99                                     as radiation_motif_ordre_affichage,\n        'Non disponible'  as radiation_motif_libelle_long,\n        'Non disponible'  as radiation_motif_libelle_court\n            \n),\n \n\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\ncte_union_motif_radiation as\n(\n    select *\n    from cte_stg_gipsne_ref_motif_radiation\n    union\n    select *\n    from cte_default_table\n),\n\ncte_calc_stg_gipsne_ref_motif_radiation as\n(\n    select \n        *\n        ,   case    when radiation_motif_code in ('RADABA','RADIRR','RADCON') \n                    then 'Radiation'\n                    else radiation_motif_libelle_court\n            end as  radiation_motif_libelle_groupe\n    from \n        cte_union_motif_radiation\n    \n),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc_stg_gipsne_ref_motif_radiation as\n(\n    select\n        *\n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        cast(radiation_motif_code as varchar(max))\n    \n)  \n \n as radiation_motif_hk\n    from \n        cte_calc_stg_gipsne_ref_motif_radiation\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_gipsne_ref_motif_radiation\n )\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_radiation_motif\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:55.402407Z", "completed_at": "2025-12-10T16:28:55.405642Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:55.405986Z", "completed_at": "2025-12-10T16:28:56.735599Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3342516422271729, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_situation_familiale", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table situation_familiale\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_situation_familiale\"\n * Cible :          situation_familiale\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        situation_familiale_cle,\n        situation_familiale_code,\n        situation_familiale_ordre_affichage,\n        situation_familiale_libelle_long,\n        situation_familiale_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_situation_familiale\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as situation_familiale_cle,\n        'N/A'          as situation_familiale_code,\n        0                                       as situation_familiale_ordre_affichage,\n        'Non disponible'  as situation_familiale_libelle_long,\n        'Non disponible'  as situation_familiale_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        situation_familiale_cle,\n        coalesce(situation_familiale_code,situation_familiale_cle) as  situation_familiale_code,\n        situation_familiale_ordre_affichage,\n        situation_familiale_libelle_long,\n        situation_familiale_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(situation_familiale_code as varchar(max))\n    \n)  \n \n as situation_familiale_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_situation_familiale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:56.740107Z", "completed_at": "2025-12-10T16:28:56.744970Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:56.745550Z", "completed_at": "2025-12-10T16:28:58.089431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.350696086883545, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_dalo_statut", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table dalo_statut\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_dalo\"\n * Cible :          dalo_statut\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        dalo_statut_cle,\n        dalo_statut_code,\n        dalo_statut_ordre_affichage,\n        dalo_statut_libelle_long,\n        dalo_statut_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_dalo\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as dalo_statut_cle,\n        'N/A'          as dalo_statut_code,\n        0                                       as dalo_statut_ordre_affichage,\n        'Non disponible'  as dalo_statut_libelle_long,\n        'Non disponible'  as dalo_statut_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        dalo_statut_cle,\n        coalesce(dalo_statut_code,dalo_statut_cle) as  dalo_statut_code,\n        dalo_statut_ordre_affichage,\n        dalo_statut_libelle_long,\n        dalo_statut_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(dalo_statut_code as varchar(max))\n    \n)  \n \n as dalo_statut_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_dalo_statut\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:58.094181Z", "completed_at": "2025-12-10T16:28:58.099191Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:58.100624Z", "completed_at": "2025-12-10T16:28:59.595946Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5031647682189941, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_statut_professionnel", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table statut_professionnel\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_professionnel\"\n * Cible :          statut_professionnel\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        statut_professionnel_cle,\n        statut_professionnel_code,\n        statut_professionnel_ordre_affichage,\n        statut_professionnel_libelle_long,\n        statut_professionnel_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_statut_professionnel\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as statut_professionnel_cle,\n        'N/A'          as statut_professionnel_code,\n        0                                       as statut_professionnel_ordre_affichage,\n        'Non disponible'  as statut_professionnel_libelle_long,\n        'Non disponible'  as statut_professionnel_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        statut_professionnel_cle,\n        coalesce(statut_professionnel_code,statut_professionnel_cle) as  statut_professionnel_code,\n        statut_professionnel_ordre_affichage,\n        statut_professionnel_libelle_long,\n        statut_professionnel_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(statut_professionnel_code as varchar(max))\n    \n)  \n \n as statut_professionnel_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_statut_professionnel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:28:59.601881Z", "completed_at": "2025-12-10T16:28:59.607201Z"}, {"name": "execute", "started_at": "2025-12-10T16:28:59.607856Z", "completed_at": "2025-12-10T16:29:01.036840Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4364655017852783, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demandeur_type", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table demandeur_type\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_personne\"\n * Cible :          demandeur_type\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        demandeur_type_cle,\n        demandeur_type_code,\n        demandeur_type_ordre_affichage,\n        demandeur_type_libelle_long,\n        demandeur_type_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_personne\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as demandeur_type_cle,\n        'N/A'          as demandeur_type_code,\n        0                                       as demandeur_type_ordre_affichage,\n        'Non disponible'  as demandeur_type_libelle_long,\n        'Non disponible'  as demandeur_type_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        demandeur_type_cle,\n        coalesce(demandeur_type_code,demandeur_type_cle) as  demandeur_type_code,\n        demandeur_type_ordre_affichage,\n        demandeur_type_libelle_long,\n        demandeur_type_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_type_code as varchar(max))\n    \n)  \n \n as demandeur_type_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demandeur_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:01.041218Z", "completed_at": "2025-12-10T16:29:01.046001Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:01.046614Z", "completed_at": "2025-12-10T16:29:02.357175Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3173282146453857, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_reservataire_type", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table reservataire_type\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_reservataire\"\n * Cible :          reservataire_type\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        reservataire_type_cle,\n        reservataire_type_code,\n        reservataire_type_ordre_affichage,\n        reservataire_type_libelle_long,\n        reservataire_type_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_reservataire\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as reservataire_type_cle,\n        'N/A'          as reservataire_type_code,\n        0                                       as reservataire_type_ordre_affichage,\n        'Non disponible'  as reservataire_type_libelle_long,\n        'Non disponible'  as reservataire_type_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        reservataire_type_cle,\n        coalesce(reservataire_type_code,reservataire_type_cle) as  reservataire_type_code,\n        reservataire_type_ordre_affichage,\n        reservataire_type_libelle_long,\n        reservataire_type_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(reservataire_type_code as varchar(max))\n    \n)  \n \n as reservataire_type_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_reservataire_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:02.361792Z", "completed_at": "2025-12-10T16:29:02.368108Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:02.368725Z", "completed_at": "2025-12-10T16:29:03.924506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.564051866531372, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_zone_plafond_ressource", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation de la table zone_plafond_ressource\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_zonage_plaf\"\n * Cible :          zone_plafond_ressource\n */\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_source_table as \n(\n    select \n        zone_plafond_ressource_cle,\n        zone_plafond_ressource_code,\n        zone_plafond_ressource_ordre_affichage,\n        zone_plafond_ressource_libelle_long,\n        zone_plafond_ressource_libelle_court\n    from \n        \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_zonage_plaf\"\n),\n\ncte_default_table as\n(\n    select \n        'N/A'          as zone_plafond_ressource_cle,\n        'N/A'          as zone_plafond_ressource_code,\n        0                                       as zone_plafond_ressource_ordre_affichage,\n        'Non disponible'  as zone_plafond_ressource_libelle_long,\n        'Non disponible'  as zone_plafond_ressource_libelle_court\n        \n      \n),\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n --gestion du cas ou la cl\u00e9 = le code\n cte_transform_source_table as (\n    select\n        zone_plafond_ressource_cle,\n        coalesce(zone_plafond_ressource_code,zone_plafond_ressource_cle) as  zone_plafond_ressource_code,\n        zone_plafond_ressource_ordre_affichage,\n        zone_plafond_ressource_libelle_long,\n        zone_plafond_ressource_libelle_court \n    from \n        cte_source_table\n ),\n\n --union\n cte_union_source_default_table as (\n    select * \n    from cte_transform_source_table\n    union all\n    select * \n    from cte_default_table\n\n ),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc as\n(\n    select\n            *,\n            \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as zone_plafond_ressource_hk\n    from \n        cte_union_source_default_table\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc\n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_zone_plafond_ressource\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:03.928889Z", "completed_at": "2025-12-10T16:29:03.934499Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:03.935127Z", "completed_at": "2025-12-10T16:29:06.161503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.233919620513916, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.categorie_logement", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table categorie_logement\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_categorie_logement\n * Cible :          categorie_logement\n * Cas sp\u00e9cifique: plusieurs cl\u00e9s avec le m\u00eame code car 2 tables sources alimentent int_categorie_logement\n */\n\n\n\n-- Selection des colonnes\nwith cte_int_categorie_logement as\n(\n    select \n        categorie_logement_hk\n        , categorie_logement_code\n        , categorie_logement_libelle_court\n        , categorie_logement_libelle_long\n        , categorie_logement_ordre_affichage\n        \n    from   \n        \"wh_dp_silver\".\"int\".\"int_categorie_logement\"\n),\n\n-- Distinct\ncte_distinct_int_categorie_logement as \n(\n    select distinct\n        categorie_logement_hk\n        , categorie_logement_code\n        , categorie_logement_libelle_court\n        , categorie_logement_libelle_long\n        , categorie_logement_ordre_affichage\n       \n    from \n        cte_int_categorie_logement\n\n),\n\n \ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_distinct_int_categorie_logement\n)\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"categorie_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:06.167415Z", "completed_at": "2025-12-10T16:29:06.271870Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:06.272186Z", "completed_at": "2025-12-10T16:29:07.601602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4367437362670898, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.composition_familiale", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference composition_familiale\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_composition_familiale\n * Cible :          composition_familiale\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_composition_familiale as\n(\n    select\n        composition_familiale_hk,\n        composition_familiale_cle,\n        composition_familiale_code,\n        composition_familiale_ordre_affichage,\n        composition_familiale_libelle_long,\n        composition_familiale_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as composition_familiale_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_composition_familiale\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_composition_familiale as\n(\n    select\n        composition_familiale_hk,\n        coalesce(composition_familiale_code,composition_familiale_cle) as  composition_familiale_code,\n        composition_familiale_ordre_affichage,\n        composition_familiale_libelle_long,\n        composition_familiale_libelle_court \n        \n    \n        ,null as composition_familiale_libelle_groupe\n    \n\n\n    from cte_int_composition_familiale\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_composition_familiale \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"composition_familiale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:07.604784Z", "completed_at": "2025-12-10T16:29:07.608370Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:07.608713Z", "completed_at": "2025-12-10T16:29:26.511704Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 18.908105611801147, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demande_commune_recherche", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demande_commune_recherche\n * Fr\u00e9quence :      Annuel\n * Mode :           Insert/update\n * Source:          int_demande_commune_recherche\n * Cible :          demande_commune_recherche\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_demande_commune_recherche as\n(\n    select\n        demande_commune_recherche_bk,\n        demande_commune_recherche_hk,\n        demande_commune_recherche_annee,\n        demande_commune_recherche_annee_last_flag,\n        demande_commune_recherche_ordre_priorite,\n        demande_id,\n        commune_code,\n        arrondissement_code,\n        demande_et_radiation_sne_bk,\n        commune_bk,\n        arrondissement_bk,\n        demande_et_radiation_sne_hk,\n        commune_hk,\n        arrondissement_hk\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_demande_commune_recherche\"\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_demande_commune_recherche\n)\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demande_commune_recherche\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:26.517287Z", "completed_at": "2025-12-10T16:29:26.557683Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:26.558286Z", "completed_at": "2025-12-10T16:29:28.004064Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4881086349487305, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demandeur_lien", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference demandeur_lien\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_demandeur_lien\n * Cible :          demandeur_lien\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_demandeur_lien as\n(\n    select\n        demandeur_lien_hk,\n        demandeur_lien_cle,\n        demandeur_lien_code,\n        demandeur_lien_ordre_affichage,\n        demandeur_lien_libelle_long,\n        demandeur_lien_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as demandeur_lien_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_demandeur_lien\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_demandeur_lien as\n(\n    select\n        demandeur_lien_hk,\n        coalesce(demandeur_lien_code,demandeur_lien_cle) as  demandeur_lien_code,\n        demandeur_lien_ordre_affichage,\n        demandeur_lien_libelle_long,\n        demandeur_lien_libelle_court \n        \n    \n        ,null as demandeur_lien_libelle_groupe\n    \n\n\n    from cte_int_demandeur_lien\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_demandeur_lien \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demandeur_lien\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:29:28.007160Z", "completed_at": "2025-12-10T16:29:28.012410Z"}, {"name": "execute", "started_at": "2025-12-10T16:29:28.012797Z", "completed_at": "2025-12-10T16:30:06.011307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 38.00520181655884, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demandeur_foyer", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_demandeur_foyer\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          stg_gipsne_ele_desc_foyer_demande       \n                    int_demandeur_lien      \n * Cible :          int_demandeur_foyer\n \n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_stg_gipsne_ele_desc_foyer_demande as \n(\n    select \n        demandeur_foyer_demande_id,\n        demandeur_foyer_naissance_date,\n        demandeur_foyer_age,\n        demandeur_foyer_ordre_affichage, \n        demandeur_lien_cle,\n        demandeur_foyer_annee \n\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_desc_foyer_demande\"\n),\n\n \ncte_int_demandeur_lien as\n(\n    select  \n        demandeur_lien_cle\n        , demandeur_lien_code\n    from \n        \"wh_dp_silver\".\"int\".\"int_demandeur_lien\"\n),\n\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n \ncte_calc_stg_gipsne_ele_desc_foyer_demande as\n(\n    select \n        stg.demandeur_foyer_demande_id\n        , isnull(ref.demandeur_lien_code,'N/A') \n                as demandeur_lien_code\n        , stg.demandeur_lien_cle\n        , stg.demandeur_foyer_naissance_date\n        , stg.demandeur_foyer_age\n        , stg.demandeur_foyer_annee\n        , stg.demandeur_foyer_ordre_affichage\n        , \n    case\n        when (demandeur_foyer_annee) = (\n            select max((demandeur_foyer_annee))\n            from cte_stg_gipsne_ele_desc_foyer_demande\n        ) then 1\n        else 0\n    end\n\n                as demandeur_foyer_annee_last_flag\n\n    from \n        cte_stg_gipsne_ele_desc_foyer_demande stg\n    left join\n        cte_int_demandeur_lien ref\n        on stg.demandeur_lien_cle = ref.demandeur_lien_cle\n    \n),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc_stg_gipsne_ele_desc_foyer_demande as\n(\n    select\n        *\n        ,\n    \n        concat_ws('||', demandeur_foyer_annee, demandeur_foyer_demande_id, demandeur_foyer_ordre_affichage) \n    \n \n                            as demandeur_foyer_bk  \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demandeur_foyer_annee, demandeur_foyer_demande_id, demandeur_foyer_ordre_affichage) \n    \n)  \n \n \n                            as demandeur_foyer_hk \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_lien_code as varchar(max))\n    \n)  \n \n \n                            as demandeur_lien_hk   \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demandeur_foyer_annee, demandeur_foyer_demande_id) \n    \n)  \n \n \n                            as demande_et_radiation_sne_hk\n    from \n        cte_calc_stg_gipsne_ele_desc_foyer_demande\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_gipsne_ele_desc_foyer_demande\n )\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demandeur_foyer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:06.016860Z", "completed_at": "2025-12-10T16:30:06.023326Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:06.023894Z", "completed_at": "2025-12-10T16:30:42.103961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 36.08847260475159, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demande_mode_logement_actuel", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table intermediate int_demande_mode_logement_actuel\n *                  Filtrage, regroupement, application de conditions, calculs\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          stg_gipsne_ele_mode_logement_actuel      \n                    int_mode_logement       \n * Cible :          int_demande_mode_logement_actuel\n \n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_stg_gipsne_ele_mode_logement_actuel as \n(\n    select \n        demande_mode_logement_actuel_demande_id,\n\t\tdemande_mode_logement_actuel_cle,\n\t\tdemande_mode_logement_actuel_annee,\n        demande_mode_logement_actuel_ordre_affichage\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_mode_logement_actuel\"\n),\n\n \ncte_int_mode_logement as\n(\n    select  \n        mode_logement_cle\n        , mode_logement_code\n    from \n        \"wh_dp_silver\".\"int\".\"int_mode_logement\"\n),\n\n-------------------------------------------------------------------\n--*********************** TRANSFORMATIONS *************************\n-------------------------------------------------------------------\n \ncte_calc_stg_gipsne_ele_mode_logement_actuel as\n(\n    select \n          stg.demande_mode_logement_actuel_demande_id\n\n        , ref.mode_logement_code\n        , stg.demande_mode_logement_actuel_annee\n        , stg.demande_mode_logement_actuel_ordre_affichage\n        , \n    case\n        when (demande_mode_logement_actuel_annee) = (\n            select max((demande_mode_logement_actuel_annee))\n            from cte_stg_gipsne_ele_mode_logement_actuel\n        ) then 1\n        else 0\n    end\n\n                as demande_mode_logement_actuel_annee_last_flag\n\n    from \n        cte_stg_gipsne_ele_mode_logement_actuel stg\n    left join\n        cte_int_mode_logement ref\n        on stg.demande_mode_logement_actuel_cle = ref.mode_logement_cle\n    \n),\n\n--ajout des cl\u00e9s techniques\ncte_hk_calc_stg_gipsne_ele_mode_logement_actuel as\n(\n    select\n        *\n        ,\n    \n        concat_ws('||', demande_mode_logement_actuel_annee, demande_mode_logement_actuel_demande_id, mode_logement_code) \n    \n \n                            as demande_mode_logement_actuel_bk  \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_mode_logement_actuel_annee, demande_mode_logement_actuel_demande_id, mode_logement_code) \n    \n)  \n \n \n                            as demande_mode_logement_actuel_hk  \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        cast(mode_logement_code as varchar(max))\n    \n)  \n \n \n                            as mode_logement_hk\n         \n        ,\n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_mode_logement_actuel_annee, demande_mode_logement_actuel_demande_id) \n    \n)  \n \n \n                            as demande_et_radiation_sne_hk\n    from \n        cte_calc_stg_gipsne_ele_mode_logement_actuel\n),\n\n-------------------------------------------------------------------\n--*********************** ETAPE FINALE *************************\n-------------------------------------------------------------------\ncte_finale as \n (\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from \n        cte_hk_calc_stg_gipsne_ele_mode_logement_actuel\n )\n\n \nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demande_mode_logement_actuel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:42.108624Z", "completed_at": "2025-12-10T16:30:42.150840Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:42.151308Z", "completed_at": "2025-12-10T16:30:43.674819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5673868656158447, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.mode_logement", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference mode_logement\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_mode_logement\n * Cible :          mode_logement\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_mode_logement as\n(\n    select\n        mode_logement_hk,\n        mode_logement_cle,\n        mode_logement_code,\n        mode_logement_ordre_affichage,\n        mode_logement_libelle_long,\n        mode_logement_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as mode_logement_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_mode_logement\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_mode_logement as\n(\n    select\n        mode_logement_hk,\n        coalesce(mode_logement_code,mode_logement_cle) as  mode_logement_code,\n        mode_logement_ordre_affichage,\n        mode_logement_libelle_long,\n        mode_logement_libelle_court \n        \n    \n        ,null as mode_logement_libelle_groupe\n    \n\n\n    from cte_int_mode_logement\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_mode_logement \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"mode_logement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:43.679376Z", "completed_at": "2025-12-10T16:30:43.723127Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:43.723469Z", "completed_at": "2025-12-10T16:30:45.136062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.457796335220337, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demande_motif", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference demande_motif\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_demande_motif\n * Cible :          demande_motif\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_demande_motif as\n(\n    select\n        demande_motif_hk,\n        demande_motif_cle,\n        demande_motif_code,\n        demande_motif_ordre_affichage,\n        demande_motif_libelle_long,\n        demande_motif_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as demande_motif_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_demande_motif\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_demande_motif as\n(\n    select\n        demande_motif_hk,\n        coalesce(demande_motif_code,demande_motif_cle) as  demande_motif_code,\n        demande_motif_ordre_affichage,\n        demande_motif_libelle_long,\n        demande_motif_libelle_court \n        \n    \n        ,null as demande_motif_libelle_groupe\n    \n\n\n    from cte_int_demande_motif\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_demande_motif \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demande_motif\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:45.140488Z", "completed_at": "2025-12-10T16:30:45.208060Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:45.208380Z", "completed_at": "2025-12-10T16:30:46.734186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.595088005065918, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.radiation_motif", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference radiation_motif\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_radiation_motif\n * Cible :          radiation_motif\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_radiation_motif as\n(\n    select\n        radiation_motif_hk,\n        radiation_motif_cle,\n        radiation_motif_code,\n        radiation_motif_ordre_affichage,\n        radiation_motif_libelle_long,\n        radiation_motif_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,radiation_motif_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_radiation_motif\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_radiation_motif as\n(\n    select\n        radiation_motif_hk,\n        coalesce(radiation_motif_code,radiation_motif_cle) as  radiation_motif_code,\n        radiation_motif_ordre_affichage,\n        radiation_motif_libelle_long,\n        radiation_motif_libelle_court \n        \n    \n        ,radiation_motif_libelle_groupe\n    \n\n\n    from cte_int_radiation_motif\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_radiation_motif \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"radiation_motif\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:46.738576Z", "completed_at": "2025-12-10T16:30:46.776269Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:46.776589Z", "completed_at": "2025-12-10T16:30:48.259569Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5221760272979736, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.situation_familiale", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference situation_familiale\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_situation_familiale\n * Cible :          situation_familiale\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_situation_familiale as\n(\n    select\n        situation_familiale_hk,\n        situation_familiale_cle,\n        situation_familiale_code,\n        situation_familiale_ordre_affichage,\n        situation_familiale_libelle_long,\n        situation_familiale_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as situation_familiale_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_situation_familiale\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_situation_familiale as\n(\n    select\n        situation_familiale_hk,\n        coalesce(situation_familiale_code,situation_familiale_cle) as  situation_familiale_code,\n        situation_familiale_ordre_affichage,\n        situation_familiale_libelle_long,\n        situation_familiale_libelle_court \n        \n    \n        ,null as situation_familiale_libelle_groupe\n    \n\n\n    from cte_int_situation_familiale\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_situation_familiale \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"situation_familiale\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:48.262664Z", "completed_at": "2025-12-10T16:30:48.302519Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:48.302986Z", "completed_at": "2025-12-10T16:30:49.710003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4483788013458252, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.dalo_statut", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference dalo_statut\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_dalo_statut\n * Cible :          dalo_statut\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_dalo_statut as\n(\n    select\n        dalo_statut_hk,\n        dalo_statut_cle,\n        dalo_statut_code,\n        dalo_statut_ordre_affichage,\n        dalo_statut_libelle_long,\n        dalo_statut_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as dalo_statut_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_dalo_statut\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_dalo_statut as\n(\n    select\n        dalo_statut_hk,\n        coalesce(dalo_statut_code,dalo_statut_cle) as  dalo_statut_code,\n        dalo_statut_ordre_affichage,\n        dalo_statut_libelle_long,\n        dalo_statut_libelle_court \n        \n    \n        ,null as dalo_statut_libelle_groupe\n    \n\n\n    from cte_int_dalo_statut\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_dalo_statut \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"dalo_statut\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:49.715091Z", "completed_at": "2025-12-10T16:30:49.756994Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:49.757597Z", "completed_at": "2025-12-10T16:30:51.135436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4218058586120605, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.statut_professionnel", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference statut_professionnel\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_statut_professionnel\n * Cible :          statut_professionnel\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_statut_professionnel as\n(\n    select\n        statut_professionnel_hk,\n        statut_professionnel_cle,\n        statut_professionnel_code,\n        statut_professionnel_ordre_affichage,\n        statut_professionnel_libelle_long,\n        statut_professionnel_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as statut_professionnel_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_statut_professionnel\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_statut_professionnel as\n(\n    select\n        statut_professionnel_hk,\n        coalesce(statut_professionnel_code,statut_professionnel_cle) as  statut_professionnel_code,\n        statut_professionnel_ordre_affichage,\n        statut_professionnel_libelle_long,\n        statut_professionnel_libelle_court \n        \n    \n        ,null as statut_professionnel_libelle_groupe\n    \n\n\n    from cte_int_statut_professionnel\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_statut_professionnel \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"statut_professionnel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:51.139734Z", "completed_at": "2025-12-10T16:30:51.181181Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:51.181589Z", "completed_at": "2025-12-10T16:30:52.567878Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4294438362121582, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demandeur_type", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference demandeur_type\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_demandeur_type\n * Cible :          demandeur_type\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_demandeur_type as\n(\n    select\n        demandeur_type_hk,\n        demandeur_type_cle,\n        demandeur_type_code,\n        demandeur_type_ordre_affichage,\n        demandeur_type_libelle_long,\n        demandeur_type_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as demandeur_type_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_demandeur_type\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_demandeur_type as\n(\n    select\n        demandeur_type_hk,\n        coalesce(demandeur_type_code,demandeur_type_cle) as  demandeur_type_code,\n        demandeur_type_ordre_affichage,\n        demandeur_type_libelle_long,\n        demandeur_type_libelle_court \n        \n    \n        ,null as demandeur_type_libelle_groupe\n    \n\n\n    from cte_int_demandeur_type\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_demandeur_type \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demandeur_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:52.572153Z", "completed_at": "2025-12-10T16:30:52.611597Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:52.611972Z", "completed_at": "2025-12-10T16:30:53.946492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3758273124694824, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.reservataire_type", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference reservataire_type\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_reservataire_type\n * Cible :          reservataire_type\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_reservataire_type as\n(\n    select\n        reservataire_type_hk,\n        reservataire_type_cle,\n        reservataire_type_code,\n        reservataire_type_ordre_affichage,\n        reservataire_type_libelle_long,\n        reservataire_type_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as reservataire_type_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_reservataire_type\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_reservataire_type as\n(\n    select\n        reservataire_type_hk,\n        coalesce(reservataire_type_code,reservataire_type_cle) as  reservataire_type_code,\n        reservataire_type_ordre_affichage,\n        reservataire_type_libelle_long,\n        reservataire_type_libelle_court \n        \n    \n        ,null as reservataire_type_libelle_groupe\n    \n\n\n    from cte_int_reservataire_type\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_reservataire_type \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"reservataire_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:30:53.954422Z", "completed_at": "2025-12-10T16:30:53.974634Z"}, {"name": "execute", "started_at": "2025-12-10T16:30:53.975066Z", "completed_at": "2025-12-10T16:33:38.222613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 164.26928853988647, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_demande_sne", "compiled": true, "compiled_code": "\n\n \n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLES DE REFERENCE *********************\n-------------------------------------------------------------------\n-- Tables de r\u00e9f\u00e9rence simples  \ncte_int_demande_motif as (\n    select demande_motif_cle, demande_motif_code\n    from \"wh_dp_silver\".\"int\".\"int_demande_motif\"\n),\n\ncte_int_statut_professionnel as (\n    select statut_professionnel_cle, statut_professionnel_code\n    from \"wh_dp_silver\".\"int\".\"int_statut_professionnel\"\n),\n\ncte_int_situation_familiale as (\n    select situation_familiale_cle, situation_familiale_code\n    from \"wh_dp_silver\".\"int\".\"int_situation_familiale\"\n),\n\ncte_int_categorie_logement as (\n    select categorie_logement_cle, categorie_logement_code\n    from \"wh_dp_silver\".\"int\".\"int_categorie_logement\"\n),\n\ncte_int_zone_plafond_ressource as (\n    select zone_plafond_ressource_cle, zone_plafond_ressource_code\n    from \"wh_dp_silver\".\"int\".\"int_zone_plafond_ressource\"\n),\n\ncte_int_mode_logement as (\n    select mode_logement_cle, mode_logement_code\n    from \"wh_dp_silver\".\"int\".\"int_mode_logement\" \n),\n\ncte_int_statut_dalo as (\n    select dalo_statut_cle, dalo_statut_code\n    from \"wh_dp_silver\".\"int\".\"int_dalo_statut\"\n),\n\ncte_int_demandeur_lien as (\n    select demandeur_lien_cle, demandeur_lien_code\n    from \"wh_dp_silver\".\"int\".\"int_demandeur_lien\"\n),\n\ncte_demandeur_age_tranche as (\n    select demandeur_age_tranche_code, demandeur_age_tranche_min, demandeur_age_tranche_max\n    from \"wh_dp_silver\".\"dbo\".\"demandeur_age_tranche\"\n),\n\ncte_int_radiation_motif as (\n    select radiation_motif_cle, radiation_motif_code\n    from \"wh_dp_silver\".\"int\".\"int_radiation_motif\"\n),\n\ncte_int_reservataire_type as (\n    select reservataire_type_cle, reservataire_type_code\n    from \"wh_dp_silver\".\"int\".\"int_reservataire_type\"\n),\n\n-------------------------------------------------------------------\n--******************* TABLES DE MAPPING ***************************\n-------------------------------------------------------------------\ncte_map_piece_nombre as (\n    select \n        sne.piece_nombre_sne_cle as piece_nombre_cle,\n        map.ref_piece_nombre_code as piece_nombre_code,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when map.ref_piece_nombre_code is null \n          or map.ref_piece_nombre_code in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(map.ref_piece_nombre_code as integer) is not null \n        then cast(map.ref_piece_nombre_code as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(map.ref_piece_nombre_code as float) is not null \n        then cast(cast(map.ref_piece_nombre_code as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as piece_nombre_int\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_logement\" sne\n    inner join \"wh_dp_bronze\".\"seed\".\"map_piece_nombre_code\" map\n        on sne.piece_nombre_sne_code = map.sne_piece_nombre_code\n),\n\n-------------------------------------------------------------------\n--****************** TABLES GEOGRAPHIQUES *************************\n-------------------------------------------------------------------\ncte_geographie as (\n    select geographie_sne_commune_cle, geographie_sne_commune_code, geographie_sne_annee\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_geographie\"\n),\n\ncte_commune as (\n    select commune_code, commune_annee\n    from \"wh_dp_silver\".\"int\".\"int_commune\"\n    where \n    case\n        when (commune_annee) = (\n            select max((commune_annee))\n            from int_commune\n        ) then 1\n        else 0\n    end\n = 1\n),\n\ncte_arrondissement as (\n    select arrondissement_code, arrondissement_annee, commune_code\n    from \"wh_dp_silver\".\"int\".\"int_arrondissement\"\n    where \n    case\n        when (arrondissement_annee) = (\n            select max((arrondissement_annee))\n            from int_arrondissement\n        ) then 1\n        else 0\n    end\n = 1\n),\n\n-------------------------------------------------------------------\n--************************* JOINTURES *****************************\n-------------------------------------------------------------------\ncte_dalo as (\n    select \n        ele.demande_id,\n        ele.dalo_annee,\n        ele.dalo_decision_date,\n        coalesce(ref.dalo_statut_code, 'N/A') as dalo_statut_code\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_information_dalo\" ele\n    left join cte_int_statut_dalo ref on ele.dalo_statut_cle = ref.dalo_statut_cle\n),\n\ncte_foyer_couple as (\n    select \n        stg.demandeur_foyer_demande_id,\n        stg.demandeur_foyer_annee,\n        ref.demandeur_lien_code,\n        stg.demandeur_foyer_age\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_desc_foyer_demande\" stg\n    inner join cte_int_demandeur_lien ref on stg.demandeur_lien_cle = ref.demandeur_lien_cle\n    where ref.demandeur_lien_code in ('LDEC','LDEM','LDER','LDEP')\n),\n\n-------------------------------------------------------------------\n--***************** TABLE SOURCE PRINCIPALE ***********************\n-------------------------------------------------------------------\ncte_source as (\n    select \n        -- Informations demande\n        demande_et_radiation_sne_millesime,\n        demande_et_radiation_sne_millesime_date,\n        demande_numero,\n        demande_id,\n        demande_motif_premier_cle,\n        demande_creation_date,\n        \n        -- Informations demandeur\n        demandeur_type_code,\n        demandeur_naissance_date,\n        demandeur_age,\n        demandeur_sexe_cle,\n        demandeur_nationalite_cle,\n        demandeur_statut_professionnel_cle,\n        demandeur_situation_familiale_cle,\n        demandeur_composition_familiale_code,\n        demandeur_revenu_mensuel_montant,\n\n        -- Informations foyer\n        foyer_taille,\n        cotitulaire_nombre,\n        personne_a_charge_nombre,\n        unite_de_consommation_nombre,\n        foyer_revenu_mensuel_montant,\n        foyer_revenu_fiscal_1_montant,\n        foyer_revenu_fiscal_2_montant,\n        \n        -- Logement actuel\n        logement_actuel_categorie_cle,\n        logement_actuel_piece_nombre_cle,\n        logement_actuel_mode_logement_cle,\n        logement_actuel_commune_cle,\n        logement_actuel_zone_plafond_ressource_cle,\n        \n        -- Logement recherch\u00e9\n        logement_recherche_categorie_cle,\n        logement_recherche_piece_nombre_cle,\n        logement_recherche_commune_cle,\n        logement_recherche_zone_plafond_ressource_cle,\n        \n        -- Autres indicateurs\n        apl_mensuel_montant,\n        mutation_flag,\n        anru_flag,\n        cerfa_version_code,\n        handicape_nombre,\n        \n        -- Colonnes sp\u00e9cifiques radiation (NULL pour stock)\n        radiation_motif_cle,\n        qpv_flag as qpv_flag_source,\n        radiation_date as radiation_date_source,\n        reservataire_type_cle,\n        radiation_siren_numero as radiation_siren_numero_source,\n        logement_rpls_id as logement_rpls_id_source,\n        logement_attribue_piece_nombre_cle,\n        logement_attribue_commune_cle,\n        logement_attribue_zone_plafond_ressource_cle,\n        attribution_delai_jour_nombre as attribution_delai_jour_nombre_source\n        \n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_stock\"\n),\n\n-------------------------------------------------------------------\n--********************* TRANSFORMATION PRINCIPALE *****************\n-------------------------------------------------------------------\ncte_transform as (\n    select \n        src.*,\n        \n        -- Flags mill\u00e9sime\n        \n    case\n        when (demande_et_radiation_sne_millesime) = (\n            select max((demande_et_radiation_sne_millesime))\n            from cte_source\n        ) then 1\n        else 0\n    end\n as demande_et_radiation_sne_millesime_last_flag,\n        cast(case when year(src.demande_creation_date) = src.demande_et_radiation_sne_millesime \n            then 1 else 0 end as bit) as demande_nouvelle_flag,\n        \n        -- Codes de r\u00e9f\u00e9rence enrichis\n        coalesce(motif.demande_motif_code, 'N/A') as demande_motif_premier_code,\n        coalesce(statut.statut_professionnel_code, 'N/A') as demandeur_statut_professionnel_code,\n        coalesce(situation.situation_familiale_code, 'N/A') as demandeur_situation_familiale_code,\n        coalesce(age_tranche.demandeur_age_tranche_code, 'N/A') as demandeur_age_tranche_code,\n        \n        -- Logement actuel\n        coalesce(categ_act.categorie_logement_code, 'N/A') as logement_actuel_categorie_logement_code,\n        coalesce(piece_act.piece_nombre_code, 'N/A') as logement_actuel_piece_nombre_code,\n        coalesce(mode_log.mode_logement_code, 'N/A') as logement_actuel_mode_logement_code,\n        coalesce(zone_act.zone_plafond_ressource_code, 'N/A') as logement_actuel_zone_plafond_ressource_code,\n        coalesce(arr_act.commune_code, geo_act.geographie_sne_commune_code) as logement_actuel_commune_code,\n        coalesce(arr_act.arrondissement_code, 'N/A') as logement_actuel_arrondissement_code,\n        \n        -- Logement recherch\u00e9\n        coalesce(categ_rech.categorie_logement_code, 'N/A') as logement_recherche_categorie_logement_code,\n        coalesce(piece_rech.piece_nombre_code, 'N/A') as logement_recherche_piece_nombre_code,\n        coalesce(zone_rech.zone_plafond_ressource_code, 'N/A') as logement_recherche_zone_plafond_ressource_code,\n        coalesce(arr_rech.commune_code, geo_rech.geographie_sne_commune_code) as logement_recherche_commune_code,\n        coalesce(arr_rech.arrondissement_code, 'N/A') as logement_recherche_arrondissement_code,\n        \n        -- DALO\n        coalesce(dalo.dalo_statut_code, 'N/A') as dalo_statut_code,\n        cast(case when upper(dalo.dalo_statut_code) = 'NON' or dalo.dalo_statut_code is null \n            then 0 else 1 end as bit) as dalo_flag,\n        \n        -- Indicateurs foyer\n        cast(case when src.foyer_taille = 1 then 1 else 0 end as bit) as foyer_personne_isole_flag,\n        cast(case when couple.demandeur_foyer_demande_id is not null then 1 else 0 end as bit) as foyer_couple_flag,\n        cast(case when src.personne_a_charge_nombre > 0 \n            and src.foyer_taille - src.personne_a_charge_nombre = 1 then 1 else 0 end as bit) as foyer_famille_monoparentale_flag,\n        case when couple.demandeur_foyer_demande_id is not null then src.personne_a_charge_nombre else 0 end as foyer_enfant_nombre,\n        case when couple.demandeur_foyer_demande_id is not null then couple.demandeur_foyer_age else 0 end as foyer_conjoint_age,\n        case when couple.demandeur_foyer_demande_id is not null \n            then couple.demandeur_foyer_age + src.demandeur_age else 0 end as foyer_couple_age,\n        case when (couple.demandeur_foyer_demande_id is not null \n                and couple.demandeur_foyer_age + src.demandeur_age <= 55)\n            or (src.foyer_taille = 1 and src.demandeur_age <= 28) \n            then 1 else 0 end as foyer_jeune_menage,\n        \n        -- Anciennet\u00e9 demande\n        datediff(day, src.demande_creation_date, datefromparts(src.demande_et_radiation_sne_millesime, 12, 31)) as demande_anciennete_jour_nombre,\n        datediff(month, src.demande_creation_date, datefromparts(src.demande_et_radiation_sne_millesime, 12, 31)) as demande_anciennete_mois_nombre,\n        \n        -- Indicateurs radiation (conditionnels sur source_type)\n        cast(case when 'stock' = 'radiation' then 1 else 0 end as bit) as radiation_flag,\n        cast(case when 'stock' = 'radiation' and rad_motif.radiation_motif_code = 'RADATT' \n            then 1 else 0 end as bit) as attribution_flag,\n        cast(case when 'stock' = 'radiation' and rad_motif.radiation_motif_code <> 'RADATT' \n            then 1 else 0 end as bit) as radiation_hors_attribution_flag,\n        \n        -- Dates radiation\n        case when 'stock' = 'radiation' then src.radiation_date_source \n            else CAST(NULL AS DATE) end as radiation_date,\n        case when 'stock' = 'radiation' and rad_motif.radiation_motif_code = 'RADATT' \n            then src.radiation_date_source else CAST(NULL AS DATE) end as attribution_date,\n        \n        -- Codes radiation\n        coalesce(case when 'stock' = 'radiation' then rad_motif.radiation_motif_code end, \n            'N/A') as radiation_motif_code,\n        coalesce(case when 'stock' = 'radiation' then reserv.reservataire_type_code end, \n            'N/A') as reservataire_type_code,\n        \n        -- Logement attribu\u00e9 (g\u00e9ographie)\n        coalesce(case when 'stock' = 'radiation' \n            then coalesce(arr_attrib.commune_code, geo_attrib.geographie_sne_commune_code) end, \n            'N/A') as logement_attribue_commune_code,\n        coalesce(case when 'stock' = 'radiation' then arr_attrib.arrondissement_code end, \n            'N/A') as logement_attribue_arrondissement_code,\n        coalesce(case when 'stock' = 'radiation' then zone_attrib.zone_plafond_ressource_code end, \n            'N/A') as logement_attribue_zone_plafond_ressource_code,\n        coalesce(case when 'stock' = 'radiation' then piece_attrib.piece_nombre_code end, \n            'N/A') as logement_attribue_piece_nombre_code,\n        \n        -- Autres champs radiation\n        case when 'stock' = 'radiation' then src.qpv_flag_source else 0 end as qpv_flag,\n        coalesce(case when 'stock' = 'radiation' then src.radiation_siren_numero_source end, \n            'N/A') as radiation_siren_numero,\n        coalesce(case when 'stock' = 'radiation' then src.logement_rpls_id_source end, \n            'N/A') as logement_rpls_id,\n        coalesce(case when 'stock' = 'radiation' then src.attribution_delai_jour_nombre_source end, \n            CAST(NULL AS INTEGER)) as attribution_delai_jour_nombre,\n        coalesce(case when 'stock' = 'radiation' \n            then floor(src.attribution_delai_jour_nombre_source / 30.4375) end, \n            CAST(NULL AS INTEGER)) as attribution_delai_mois_nombre,\n        \n        -- Ad\u00e9quation pi\u00e8ces\n        coalesce(case when 'stock' = 'radiation' then\n            case\n                when piece_rech.piece_nombre_int - 1 = piece_attrib.piece_nombre_int then 'PETIT'\n                when piece_rech.piece_nombre_int + 1 <= piece_attrib.piece_nombre_int then 'GRAND'\n                when piece_rech.piece_nombre_int = piece_attrib.piece_nombre_int then 'EQUIVALENT'\n            end end, 'N/A') as piece_nombre_adequation_code\n        \n    from cte_source src\n    \n    -- Jointures r\u00e9f\u00e9rences simples\n    left join cte_int_demande_motif motif on src.demande_motif_premier_cle = motif.demande_motif_cle\n    left join cte_int_statut_professionnel statut on src.demandeur_statut_professionnel_cle = statut.statut_professionnel_cle\n    left join cte_int_situation_familiale situation on src.demandeur_situation_familiale_cle = situation.situation_familiale_cle\n    left join cte_demandeur_age_tranche age_tranche \n        on src.demandeur_age between age_tranche.demandeur_age_tranche_min and age_tranche.demandeur_age_tranche_max\n    \n    -- Logement actuel\n    left join cte_int_categorie_logement categ_act on src.logement_actuel_categorie_cle = categ_act.categorie_logement_cle\n    left join cte_map_piece_nombre piece_act on src.logement_actuel_piece_nombre_cle = piece_act.piece_nombre_cle\n    left join cte_int_mode_logement mode_log on src.logement_actuel_mode_logement_cle = mode_log.mode_logement_cle\n    left join cte_int_zone_plafond_ressource zone_act on src.logement_actuel_zone_plafond_ressource_cle = zone_act.zone_plafond_ressource_cle\n    left join cte_geographie geo_act on src.logement_actuel_commune_cle = geo_act.geographie_sne_commune_cle\n    left join cte_arrondissement arr_act on geo_act.geographie_sne_commune_code = arr_act.arrondissement_code\n    \n    -- Logement recherch\u00e9\n    left join cte_int_categorie_logement categ_rech on src.logement_recherche_categorie_cle = categ_rech.categorie_logement_cle\n    left join cte_map_piece_nombre piece_rech on src.logement_recherche_piece_nombre_cle = piece_rech.piece_nombre_cle\n    left join cte_int_zone_plafond_ressource zone_rech on src.logement_recherche_zone_plafond_ressource_cle = zone_rech.zone_plafond_ressource_cle\n    left join cte_geographie geo_rech on src.logement_recherche_commune_cle = geo_rech.geographie_sne_commune_cle\n    left join cte_arrondissement arr_rech on geo_rech.geographie_sne_commune_code = arr_rech.arrondissement_code\n    \n    -- DALO et foyer\n    left join cte_dalo dalo on src.demande_id = dalo.demande_id\n    left join cte_foyer_couple couple on src.demande_id = couple.demandeur_foyer_demande_id\n    \n    -- Jointures sp\u00e9cifiques radiation\n    left join cte_int_radiation_motif rad_motif on src.radiation_motif_cle = rad_motif.radiation_motif_cle\n    left join cte_int_reservataire_type reserv on src.reservataire_type_cle = reserv.reservataire_type_cle\n    left join cte_geographie geo_attrib on src.logement_attribue_commune_cle = geo_attrib.geographie_sne_commune_cle\n    left join cte_arrondissement arr_attrib on geo_attrib.geographie_sne_commune_code = arr_attrib.arrondissement_code\n    left join cte_int_zone_plafond_ressource zone_attrib on src.logement_attribue_zone_plafond_ressource_cle = zone_attrib.zone_plafond_ressource_cle\n    left join cte_map_piece_nombre piece_attrib on src.logement_attribue_piece_nombre_cle = piece_attrib.piece_nombre_cle\n),\n\n-------------------------------------------------------------------\n--********************* CLES TECHNIQUES ***************************\n-------------------------------------------------------------------\ncte_with_keys as (\n    select \n        t.*,\n        \n        -- Cl\u00e9s principales\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_et_radiation_sne_millesime, demande_id) \n    \n)  \n \n as demande_et_radiation_sne_hk,\n        \n    \n        concat_ws('||', demande_et_radiation_sne_millesime, demande_id) \n    \n as demande_et_radiation_sne_bk,\n        \n        -- Cl\u00e9s demandeur\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demande_motif_premier_code as varchar(max))\n    \n)  \n \n as demande_motif_premier_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_statut_professionnel_code as varchar(max))\n    \n)  \n \n as demandeur_statut_professionnel_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_situation_familiale_code as varchar(max))\n    \n)  \n \n as demandeur_situation_familiale_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_composition_familiale_code as varchar(max))\n    \n)  \n \n as demandeur_composition_familiale_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_age_tranche_code as varchar(max))\n    \n)  \n \n as demandeur_age_tranche_hk,\n        \n        -- Cl\u00e9s logement actuel\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_categorie_logement_code as varchar(max))\n    \n)  \n \n as logement_actuel_categorie_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_actuel_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_mode_logement_code as varchar(max))\n    \n)  \n \n as logement_actuel_mode_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_actuel_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_act.commune_annee, logement_actuel_commune_code) \n    \n)  \n \n as logement_actuel_commune_hk,\n        \n    \n        concat_ws('||', commune_act.commune_annee, logement_actuel_commune_code) \n    \n as logement_actuel_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_act.arrondissement_annee, logement_actuel_arrondissement_code) \n    \n)  \n \n as logement_actuel_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_act.arrondissement_annee, logement_actuel_arrondissement_code) \n    \n as logement_actuel_arrondissement_bk,\n        \n        -- Cl\u00e9s logement recherch\u00e9\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_categorie_logement_code as varchar(max))\n    \n)  \n \n as logement_recherche_categorie_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_recherche_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_recherche_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_rech.commune_annee, logement_recherche_commune_code) \n    \n)  \n \n as logement_recherche_commune_hk,\n        \n    \n        concat_ws('||', commune_rech.commune_annee, logement_recherche_commune_code) \n    \n as logement_recherche_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_recherche_arrondissement_code) \n    \n)  \n \n as logement_recherche_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_recherche_arrondissement_code) \n    \n as logement_recherche_arrondissement_bk,\n        \n         -- Cl\u00e9s logement attribue\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_attribue_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_attribue_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_attribue_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_attribue_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_rech.commune_annee, logement_attribue_commune_code) \n    \n)  \n \n as logement_attribue_commune_hk,\n        \n    \n        concat_ws('||', commune_rech.commune_annee, logement_attribue_commune_code) \n    \n as logement_attribue_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_attribue_arrondissement_code) \n    \n)  \n \n as logement_attribue_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_attribue_arrondissement_code) \n    \n as logement_attribue_arrondissement_bk,\n        \n        -- Cl\u00e9s DALO\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(dalo_statut_code as varchar(max))\n    \n)  \n \n as dalo_statut_hk,\n        \n        -- Cl\u00e9s radiation\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(radiation_motif_code as varchar(max))\n    \n)  \n \n as radiation_motif_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(reservataire_type_code as varchar(max))\n    \n)  \n \n as reservataire_type_hk,\n           \n        -- M\u00e9tadonn\u00e9es\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n        \n    from cte_transform t\n    \n    -- Jointures pour construire les cl\u00e9s avec ann\u00e9es\n    left join cte_commune commune_act on t.logement_actuel_commune_code = commune_act.commune_code\n    left join cte_arrondissement arr_act on t.logement_actuel_arrondissement_code = arr_act.arrondissement_code\n    left join cte_commune commune_rech on t.logement_recherche_commune_code = commune_rech.commune_code\n    left join cte_arrondissement arr_rech on t.logement_recherche_arrondissement_code = arr_rech.arrondissement_code\n    left join cte_commune commune_attrib on t.logement_attribue_commune_code = commune_attrib.commune_code\n    left join cte_arrondissement arr_attrib on t.logement_attribue_arrondissement_code = arr_attrib.arrondissement_code\n)\n\n-------------------------------------------------------------------\n--************************ RESULTAT FINAL *************************\n-------------------------------------------------------------------\nselect * from cte_with_keys\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_demande_sne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:33:38.225708Z", "completed_at": "2025-12-10T16:33:38.231275Z"}, {"name": "execute", "started_at": "2025-12-10T16:33:38.231736Z", "completed_at": "2025-12-10T16:35:48.694413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 130.46982192993164, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.int_radiation_sne", "compiled": true, "compiled_code": "\n\n \n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLES DE REFERENCE *********************\n-------------------------------------------------------------------\n-- Tables de r\u00e9f\u00e9rence simples  \ncte_int_demande_motif as (\n    select demande_motif_cle, demande_motif_code\n    from \"wh_dp_silver\".\"int\".\"int_demande_motif\"\n),\n\ncte_int_statut_professionnel as (\n    select statut_professionnel_cle, statut_professionnel_code\n    from \"wh_dp_silver\".\"int\".\"int_statut_professionnel\"\n),\n\ncte_int_situation_familiale as (\n    select situation_familiale_cle, situation_familiale_code\n    from \"wh_dp_silver\".\"int\".\"int_situation_familiale\"\n),\n\ncte_int_categorie_logement as (\n    select categorie_logement_cle, categorie_logement_code\n    from \"wh_dp_silver\".\"int\".\"int_categorie_logement\"\n),\n\ncte_int_zone_plafond_ressource as (\n    select zone_plafond_ressource_cle, zone_plafond_ressource_code\n    from \"wh_dp_silver\".\"int\".\"int_zone_plafond_ressource\"\n),\n\ncte_int_mode_logement as (\n    select mode_logement_cle, mode_logement_code\n    from \"wh_dp_silver\".\"int\".\"int_mode_logement\" \n),\n\ncte_int_statut_dalo as (\n    select dalo_statut_cle, dalo_statut_code\n    from \"wh_dp_silver\".\"int\".\"int_dalo_statut\"\n),\n\ncte_int_demandeur_lien as (\n    select demandeur_lien_cle, demandeur_lien_code\n    from \"wh_dp_silver\".\"int\".\"int_demandeur_lien\"\n),\n\ncte_demandeur_age_tranche as (\n    select demandeur_age_tranche_code, demandeur_age_tranche_min, demandeur_age_tranche_max\n    from \"wh_dp_silver\".\"dbo\".\"demandeur_age_tranche\"\n),\n\ncte_int_radiation_motif as (\n    select radiation_motif_cle, radiation_motif_code\n    from \"wh_dp_silver\".\"int\".\"int_radiation_motif\"\n),\n\ncte_int_reservataire_type as (\n    select reservataire_type_cle, reservataire_type_code\n    from \"wh_dp_silver\".\"int\".\"int_reservataire_type\"\n),\n\n-------------------------------------------------------------------\n--******************* TABLES DE MAPPING ***************************\n-------------------------------------------------------------------\ncte_map_piece_nombre as (\n    select \n        sne.piece_nombre_sne_cle as piece_nombre_cle,\n        map.ref_piece_nombre_code as piece_nombre_code,\n        \n    case\n        -- Valeurs nulles ou codes \u00e0 ignorer\n        when map.ref_piece_nombre_code is null \n          or map.ref_piece_nombre_code in ('999', 'NA') \n        then CAST(NULL AS INTEGER)\n\n        -- Cas o\u00f9 la valeur peut \u00eatre cast\u00e9e directement en entier\n        when try_cast(map.ref_piece_nombre_code as integer) is not null \n        then cast(map.ref_piece_nombre_code as integer)\n\n        -- Cas o\u00f9 la valeur est au format scientifique (ex: '1.1144e+006')\n        when try_cast(map.ref_piece_nombre_code as float) is not null \n        then cast(cast(map.ref_piece_nombre_code as float) as integer)\n\n        -- Sinon, valeur par d\u00e9faut\n        else CAST(NULL AS INTEGER)\n    end\n as piece_nombre_int\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_type_logement\" sne\n    inner join \"wh_dp_bronze\".\"seed\".\"map_piece_nombre_code\" map\n        on sne.piece_nombre_sne_code = map.sne_piece_nombre_code\n),\n\n-------------------------------------------------------------------\n--****************** TABLES GEOGRAPHIQUES *************************\n-------------------------------------------------------------------\ncte_geographie as (\n    select geographie_sne_commune_cle, geographie_sne_commune_code, geographie_sne_annee\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ref_geographie\"\n),\n\ncte_commune as (\n    select commune_code, commune_annee\n    from \"wh_dp_silver\".\"int\".\"int_commune\"\n    where \n    case\n        when (commune_annee) = (\n            select max((commune_annee))\n            from int_commune\n        ) then 1\n        else 0\n    end\n = 1\n),\n\ncte_arrondissement as (\n    select arrondissement_code, arrondissement_annee, commune_code\n    from \"wh_dp_silver\".\"int\".\"int_arrondissement\"\n    where \n    case\n        when (arrondissement_annee) = (\n            select max((arrondissement_annee))\n            from int_arrondissement\n        ) then 1\n        else 0\n    end\n = 1\n),\n\n-------------------------------------------------------------------\n--************************* JOINTURES *****************************\n-------------------------------------------------------------------\ncte_dalo as (\n    select \n        ele.demande_id,\n        ele.dalo_annee,\n        ele.dalo_decision_date,\n        coalesce(ref.dalo_statut_code, 'N/A') as dalo_statut_code\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_information_dalo\" ele\n    left join cte_int_statut_dalo ref on ele.dalo_statut_cle = ref.dalo_statut_cle\n),\n\ncte_foyer_couple as (\n    select \n        stg.demandeur_foyer_demande_id,\n        stg.demandeur_foyer_annee,\n        ref.demandeur_lien_code,\n        stg.demandeur_foyer_age\n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_ele_desc_foyer_demande\" stg\n    inner join cte_int_demandeur_lien ref on stg.demandeur_lien_cle = ref.demandeur_lien_cle\n    where ref.demandeur_lien_code in ('LDEC','LDEM','LDER','LDEP')\n),\n\n-------------------------------------------------------------------\n--***************** TABLE SOURCE PRINCIPALE ***********************\n-------------------------------------------------------------------\ncte_source as (\n    select \n        -- Informations demande\n        demande_et_radiation_sne_millesime,\n        demande_et_radiation_sne_millesime_date,\n        demande_numero,\n        demande_id,\n        demande_motif_premier_cle,\n        demande_creation_date,\n        \n        -- Informations demandeur\n        demandeur_type_code,\n        demandeur_naissance_date,\n        demandeur_age,\n        demandeur_sexe_cle,\n        demandeur_nationalite_cle,\n        demandeur_statut_professionnel_cle,\n        demandeur_situation_familiale_cle,\n        demandeur_composition_familiale_code,\n        demandeur_revenu_mensuel_montant,\n\n        -- Informations foyer\n        foyer_taille,\n        cotitulaire_nombre,\n        personne_a_charge_nombre,\n        unite_de_consommation_nombre,\n        foyer_revenu_mensuel_montant,\n        foyer_revenu_fiscal_1_montant,\n        foyer_revenu_fiscal_2_montant,\n        \n        -- Logement actuel\n        logement_actuel_categorie_cle,\n        logement_actuel_piece_nombre_cle,\n        logement_actuel_mode_logement_cle,\n        logement_actuel_commune_cle,\n        logement_actuel_zone_plafond_ressource_cle,\n        \n        -- Logement recherch\u00e9\n        logement_recherche_categorie_cle,\n        logement_recherche_piece_nombre_cle,\n        logement_recherche_commune_cle,\n        logement_recherche_zone_plafond_ressource_cle,\n        \n        -- Autres indicateurs\n        apl_mensuel_montant,\n        mutation_flag,\n        anru_flag,\n        cerfa_version_code,\n        handicape_nombre,\n        \n        -- Colonnes sp\u00e9cifiques radiation (NULL pour stock)\n        radiation_motif_cle,\n        qpv_flag as qpv_flag_source,\n        radiation_date as radiation_date_source,\n        reservataire_type_cle,\n        radiation_siren_numero as radiation_siren_numero_source,\n        logement_rpls_id as logement_rpls_id_source,\n        logement_attribue_piece_nombre_cle,\n        logement_attribue_commune_cle,\n        logement_attribue_zone_plafond_ressource_cle,\n        attribution_delai_jour_nombre as attribution_delai_jour_nombre_source\n        \n    from \"wh_dp_silver\".\"stg\".\"stg_gipsne_radiation\"\n),\n\n-------------------------------------------------------------------\n--********************* TRANSFORMATION PRINCIPALE *****************\n-------------------------------------------------------------------\ncte_transform as (\n    select \n        src.*,\n        \n        -- Flags mill\u00e9sime\n        \n    case\n        when (demande_et_radiation_sne_millesime) = (\n            select max((demande_et_radiation_sne_millesime))\n            from cte_source\n        ) then 1\n        else 0\n    end\n as demande_et_radiation_sne_millesime_last_flag,\n        cast(case when year(src.demande_creation_date) = src.demande_et_radiation_sne_millesime \n            then 1 else 0 end as bit) as demande_nouvelle_flag,\n        \n        -- Codes de r\u00e9f\u00e9rence enrichis\n        coalesce(motif.demande_motif_code, 'N/A') as demande_motif_premier_code,\n        coalesce(statut.statut_professionnel_code, 'N/A') as demandeur_statut_professionnel_code,\n        coalesce(situation.situation_familiale_code, 'N/A') as demandeur_situation_familiale_code,\n        coalesce(age_tranche.demandeur_age_tranche_code, 'N/A') as demandeur_age_tranche_code,\n        \n        -- Logement actuel\n        coalesce(categ_act.categorie_logement_code, 'N/A') as logement_actuel_categorie_logement_code,\n        coalesce(piece_act.piece_nombre_code, 'N/A') as logement_actuel_piece_nombre_code,\n        coalesce(mode_log.mode_logement_code, 'N/A') as logement_actuel_mode_logement_code,\n        coalesce(zone_act.zone_plafond_ressource_code, 'N/A') as logement_actuel_zone_plafond_ressource_code,\n        coalesce(arr_act.commune_code, geo_act.geographie_sne_commune_code) as logement_actuel_commune_code,\n        coalesce(arr_act.arrondissement_code, 'N/A') as logement_actuel_arrondissement_code,\n        \n        -- Logement recherch\u00e9\n        coalesce(categ_rech.categorie_logement_code, 'N/A') as logement_recherche_categorie_logement_code,\n        coalesce(piece_rech.piece_nombre_code, 'N/A') as logement_recherche_piece_nombre_code,\n        coalesce(zone_rech.zone_plafond_ressource_code, 'N/A') as logement_recherche_zone_plafond_ressource_code,\n        coalesce(arr_rech.commune_code, geo_rech.geographie_sne_commune_code) as logement_recherche_commune_code,\n        coalesce(arr_rech.arrondissement_code, 'N/A') as logement_recherche_arrondissement_code,\n        \n        -- DALO\n        coalesce(dalo.dalo_statut_code, 'N/A') as dalo_statut_code,\n        cast(case when upper(dalo.dalo_statut_code) = 'NON' or dalo.dalo_statut_code is null \n            then 0 else 1 end as bit) as dalo_flag,\n        \n        -- Indicateurs foyer\n        cast(case when src.foyer_taille = 1 then 1 else 0 end as bit) as foyer_personne_isole_flag,\n        cast(case when couple.demandeur_foyer_demande_id is not null then 1 else 0 end as bit) as foyer_couple_flag,\n        cast(case when src.personne_a_charge_nombre > 0 \n            and src.foyer_taille - src.personne_a_charge_nombre = 1 then 1 else 0 end as bit) as foyer_famille_monoparentale_flag,\n        case when couple.demandeur_foyer_demande_id is not null then src.personne_a_charge_nombre else 0 end as foyer_enfant_nombre,\n        case when couple.demandeur_foyer_demande_id is not null then couple.demandeur_foyer_age else 0 end as foyer_conjoint_age,\n        case when couple.demandeur_foyer_demande_id is not null \n            then couple.demandeur_foyer_age + src.demandeur_age else 0 end as foyer_couple_age,\n        case when (couple.demandeur_foyer_demande_id is not null \n                and couple.demandeur_foyer_age + src.demandeur_age <= 55)\n            or (src.foyer_taille = 1 and src.demandeur_age <= 28) \n            then 1 else 0 end as foyer_jeune_menage,\n        \n        -- Anciennet\u00e9 demande\n        datediff(day, src.demande_creation_date, datefromparts(src.demande_et_radiation_sne_millesime, 12, 31)) as demande_anciennete_jour_nombre,\n        datediff(month, src.demande_creation_date, datefromparts(src.demande_et_radiation_sne_millesime, 12, 31)) as demande_anciennete_mois_nombre,\n        \n        -- Indicateurs radiation (conditionnels sur source_type)\n        cast(case when 'radiation' = 'radiation' then 1 else 0 end as bit) as radiation_flag,\n        cast(case when 'radiation' = 'radiation' and rad_motif.radiation_motif_code = 'RADATT' \n            then 1 else 0 end as bit) as attribution_flag,\n        cast(case when 'radiation' = 'radiation' and rad_motif.radiation_motif_code <> 'RADATT' \n            then 1 else 0 end as bit) as radiation_hors_attribution_flag,\n        \n        -- Dates radiation\n        case when 'radiation' = 'radiation' then src.radiation_date_source \n            else CAST(NULL AS DATE) end as radiation_date,\n        case when 'radiation' = 'radiation' and rad_motif.radiation_motif_code = 'RADATT' \n            then src.radiation_date_source else CAST(NULL AS DATE) end as attribution_date,\n        \n        -- Codes radiation\n        coalesce(case when 'radiation' = 'radiation' then rad_motif.radiation_motif_code end, \n            'N/A') as radiation_motif_code,\n        coalesce(case when 'radiation' = 'radiation' then reserv.reservataire_type_code end, \n            'N/A') as reservataire_type_code,\n        \n        -- Logement attribu\u00e9 (g\u00e9ographie)\n        coalesce(case when 'radiation' = 'radiation' \n            then coalesce(arr_attrib.commune_code, geo_attrib.geographie_sne_commune_code) end, \n            'N/A') as logement_attribue_commune_code,\n        coalesce(case when 'radiation' = 'radiation' then arr_attrib.arrondissement_code end, \n            'N/A') as logement_attribue_arrondissement_code,\n        coalesce(case when 'radiation' = 'radiation' then zone_attrib.zone_plafond_ressource_code end, \n            'N/A') as logement_attribue_zone_plafond_ressource_code,\n        coalesce(case when 'radiation' = 'radiation' then piece_attrib.piece_nombre_code end, \n            'N/A') as logement_attribue_piece_nombre_code,\n        \n        -- Autres champs radiation\n        case when 'radiation' = 'radiation' then src.qpv_flag_source else 0 end as qpv_flag,\n        coalesce(case when 'radiation' = 'radiation' then src.radiation_siren_numero_source end, \n            'N/A') as radiation_siren_numero,\n        coalesce(case when 'radiation' = 'radiation' then src.logement_rpls_id_source end, \n            'N/A') as logement_rpls_id,\n        coalesce(case when 'radiation' = 'radiation' then src.attribution_delai_jour_nombre_source end, \n            CAST(NULL AS INTEGER)) as attribution_delai_jour_nombre,\n        coalesce(case when 'radiation' = 'radiation' \n            then floor(src.attribution_delai_jour_nombre_source / 30.4375) end, \n            CAST(NULL AS INTEGER)) as attribution_delai_mois_nombre,\n        \n        -- Ad\u00e9quation pi\u00e8ces\n        coalesce(case when 'radiation' = 'radiation' then\n            case\n                when piece_rech.piece_nombre_int - 1 = piece_attrib.piece_nombre_int then 'PETIT'\n                when piece_rech.piece_nombre_int + 1 <= piece_attrib.piece_nombre_int then 'GRAND'\n                when piece_rech.piece_nombre_int = piece_attrib.piece_nombre_int then 'EQUIVALENT'\n            end end, 'N/A') as piece_nombre_adequation_code\n        \n    from cte_source src\n    \n    -- Jointures r\u00e9f\u00e9rences simples\n    left join cte_int_demande_motif motif on src.demande_motif_premier_cle = motif.demande_motif_cle\n    left join cte_int_statut_professionnel statut on src.demandeur_statut_professionnel_cle = statut.statut_professionnel_cle\n    left join cte_int_situation_familiale situation on src.demandeur_situation_familiale_cle = situation.situation_familiale_cle\n    left join cte_demandeur_age_tranche age_tranche \n        on src.demandeur_age between age_tranche.demandeur_age_tranche_min and age_tranche.demandeur_age_tranche_max\n    \n    -- Logement actuel\n    left join cte_int_categorie_logement categ_act on src.logement_actuel_categorie_cle = categ_act.categorie_logement_cle\n    left join cte_map_piece_nombre piece_act on src.logement_actuel_piece_nombre_cle = piece_act.piece_nombre_cle\n    left join cte_int_mode_logement mode_log on src.logement_actuel_mode_logement_cle = mode_log.mode_logement_cle\n    left join cte_int_zone_plafond_ressource zone_act on src.logement_actuel_zone_plafond_ressource_cle = zone_act.zone_plafond_ressource_cle\n    left join cte_geographie geo_act on src.logement_actuel_commune_cle = geo_act.geographie_sne_commune_cle\n    left join cte_arrondissement arr_act on geo_act.geographie_sne_commune_code = arr_act.arrondissement_code\n    \n    -- Logement recherch\u00e9\n    left join cte_int_categorie_logement categ_rech on src.logement_recherche_categorie_cle = categ_rech.categorie_logement_cle\n    left join cte_map_piece_nombre piece_rech on src.logement_recherche_piece_nombre_cle = piece_rech.piece_nombre_cle\n    left join cte_int_zone_plafond_ressource zone_rech on src.logement_recherche_zone_plafond_ressource_cle = zone_rech.zone_plafond_ressource_cle\n    left join cte_geographie geo_rech on src.logement_recherche_commune_cle = geo_rech.geographie_sne_commune_cle\n    left join cte_arrondissement arr_rech on geo_rech.geographie_sne_commune_code = arr_rech.arrondissement_code\n    \n    -- DALO et foyer\n    left join cte_dalo dalo on src.demande_id = dalo.demande_id\n    left join cte_foyer_couple couple on src.demande_id = couple.demandeur_foyer_demande_id\n    \n    -- Jointures sp\u00e9cifiques radiation\n    left join cte_int_radiation_motif rad_motif on src.radiation_motif_cle = rad_motif.radiation_motif_cle\n    left join cte_int_reservataire_type reserv on src.reservataire_type_cle = reserv.reservataire_type_cle\n    left join cte_geographie geo_attrib on src.logement_attribue_commune_cle = geo_attrib.geographie_sne_commune_cle\n    left join cte_arrondissement arr_attrib on geo_attrib.geographie_sne_commune_code = arr_attrib.arrondissement_code\n    left join cte_int_zone_plafond_ressource zone_attrib on src.logement_attribue_zone_plafond_ressource_cle = zone_attrib.zone_plafond_ressource_cle\n    left join cte_map_piece_nombre piece_attrib on src.logement_attribue_piece_nombre_cle = piece_attrib.piece_nombre_cle\n),\n\n-------------------------------------------------------------------\n--********************* CLES TECHNIQUES ***************************\n-------------------------------------------------------------------\ncte_with_keys as (\n    select \n        t.*,\n        \n        -- Cl\u00e9s principales\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', demande_et_radiation_sne_millesime, demande_id) \n    \n)  \n \n as demande_et_radiation_sne_hk,\n        \n    \n        concat_ws('||', demande_et_radiation_sne_millesime, demande_id) \n    \n as demande_et_radiation_sne_bk,\n        \n        -- Cl\u00e9s demandeur\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demande_motif_premier_code as varchar(max))\n    \n)  \n \n as demande_motif_premier_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_statut_professionnel_code as varchar(max))\n    \n)  \n \n as demandeur_statut_professionnel_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_situation_familiale_code as varchar(max))\n    \n)  \n \n as demandeur_situation_familiale_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_composition_familiale_code as varchar(max))\n    \n)  \n \n as demandeur_composition_familiale_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(demandeur_age_tranche_code as varchar(max))\n    \n)  \n \n as demandeur_age_tranche_hk,\n        \n        -- Cl\u00e9s logement actuel\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_categorie_logement_code as varchar(max))\n    \n)  \n \n as logement_actuel_categorie_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_actuel_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_mode_logement_code as varchar(max))\n    \n)  \n \n as logement_actuel_mode_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_actuel_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_actuel_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_act.commune_annee, logement_actuel_commune_code) \n    \n)  \n \n as logement_actuel_commune_hk,\n        \n    \n        concat_ws('||', commune_act.commune_annee, logement_actuel_commune_code) \n    \n as logement_actuel_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_act.arrondissement_annee, logement_actuel_arrondissement_code) \n    \n)  \n \n as logement_actuel_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_act.arrondissement_annee, logement_actuel_arrondissement_code) \n    \n as logement_actuel_arrondissement_bk,\n        \n        -- Cl\u00e9s logement recherch\u00e9\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_categorie_logement_code as varchar(max))\n    \n)  \n \n as logement_recherche_categorie_logement_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_recherche_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_recherche_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_recherche_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_rech.commune_annee, logement_recherche_commune_code) \n    \n)  \n \n as logement_recherche_commune_hk,\n        \n    \n        concat_ws('||', commune_rech.commune_annee, logement_recherche_commune_code) \n    \n as logement_recherche_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_recherche_arrondissement_code) \n    \n)  \n \n as logement_recherche_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_recherche_arrondissement_code) \n    \n as logement_recherche_arrondissement_bk,\n        \n         -- Cl\u00e9s logement attribue\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_attribue_piece_nombre_code as varchar(max))\n    \n)  \n \n as logement_attribue_piece_nombre_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(logement_attribue_zone_plafond_ressource_code as varchar(max))\n    \n)  \n \n as logement_attribue_zone_plafond_ressource_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', commune_rech.commune_annee, logement_attribue_commune_code) \n    \n)  \n \n as logement_attribue_commune_hk,\n        \n    \n        concat_ws('||', commune_rech.commune_annee, logement_attribue_commune_code) \n    \n as logement_attribue_commune_bk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_attribue_arrondissement_code) \n    \n)  \n \n as logement_attribue_arrondissement_hk,\n        \n    \n        concat_ws('||', arr_rech.arrondissement_annee, logement_attribue_arrondissement_code) \n    \n as logement_attribue_arrondissement_bk,\n        \n        -- Cl\u00e9s DALO\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(dalo_statut_code as varchar(max))\n    \n)  \n \n as dalo_statut_hk,\n        \n        -- Cl\u00e9s radiation\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(radiation_motif_code as varchar(max))\n    \n)  \n \n as radiation_motif_hk,\n        \n     \n        HASHBYTES('SHA2_256', \n    \n        cast(reservataire_type_code as varchar(max))\n    \n)  \n \n as reservataire_type_hk,\n           \n        -- M\u00e9tadonn\u00e9es\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n        \n    from cte_transform t\n    \n    -- Jointures pour construire les cl\u00e9s avec ann\u00e9es\n    left join cte_commune commune_act on t.logement_actuel_commune_code = commune_act.commune_code\n    left join cte_arrondissement arr_act on t.logement_actuel_arrondissement_code = arr_act.arrondissement_code\n    left join cte_commune commune_rech on t.logement_recherche_commune_code = commune_rech.commune_code\n    left join cte_arrondissement arr_rech on t.logement_recherche_arrondissement_code = arr_rech.arrondissement_code\n    left join cte_commune commune_attrib on t.logement_attribue_commune_code = commune_attrib.commune_code\n    left join cte_arrondissement arr_attrib on t.logement_attribue_arrondissement_code = arr_attrib.arrondissement_code\n)\n\n-------------------------------------------------------------------\n--************************ RESULTAT FINAL *************************\n-------------------------------------------------------------------\nselect * from cte_with_keys\n\n", "relation_name": "\"wh_dp_silver\".\"int\".\"int_radiation_sne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:35:48.698908Z", "completed_at": "2025-12-10T16:35:49.028972Z"}, {"name": "execute", "started_at": "2025-12-10T16:35:49.029995Z", "completed_at": "2025-12-10T16:35:50.949824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2523157596588135, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.zone_plafond_ressource", "compiled": true, "compiled_code": "\n\n/**\n *\n * Description :    Alimentation des tables de reference zone_plafond_ressource\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_zone_plafond_ressource\n * Cible :          zone_plafond_ressource\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_int_zone_plafond_ressource as\n(\n    select\n        zone_plafond_ressource_hk,\n        zone_plafond_ressource_cle,\n        zone_plafond_ressource_code,\n        zone_plafond_ressource_ordre_affichage,\n        zone_plafond_ressource_libelle_long,\n        zone_plafond_ressource_libelle_court,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at_int\n        \n    \n        ,null as zone_plafond_ressource_libelle_groupe\n    \n\n    from \"wh_dp_silver\".\"int\".\"int_zone_plafond_ressource\"\n),\n\n \n-- S\u00e9lection des colonnes \ncte_select_int_zone_plafond_ressource as\n(\n    select\n        zone_plafond_ressource_hk,\n        coalesce(zone_plafond_ressource_code,zone_plafond_ressource_cle) as  zone_plafond_ressource_code,\n        zone_plafond_ressource_ordre_affichage,\n        zone_plafond_ressource_libelle_long,\n        zone_plafond_ressource_libelle_court \n        \n    \n        ,null as zone_plafond_ressource_libelle_groupe\n    \n\n\n    from cte_int_zone_plafond_ressource\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\ncte_finale as\n(\n    select\n        *,\n        \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    from cte_select_int_zone_plafond_ressource \n)\n\nselect \n    *\nfrom \n    cte_finale\n\n", "relation_name": "\"wh_dp_silver\".\"dbo\".\"zone_plafond_ressource\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:35:51.515329Z", "completed_at": "2025-12-10T16:35:51.522368Z"}, {"name": "execute", "started_at": "2025-12-10T16:35:51.522969Z", "completed_at": "2025-12-10T16:36:01.873416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.360190153121948, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demandeur_foyer", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demandeur_foyer\n * Fr\u00e9quence :      Annuel\n * Mode :           Insert/update\n * Source:          int_demandeur_foyer\n * Cible :          demandeur_foyer\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_demandeur_foyer as\n(\n    select\n        demandeur_foyer_demande_id as demande_id\n        , demandeur_lien_code\n        , demandeur_foyer_naissance_date\n        , demandeur_foyer_age\n        , demandeur_foyer_annee\n        , demandeur_foyer_annee_last_flag\n        , demandeur_foyer_ordre_affichage\n        , demande_et_radiation_sne_hk\n        , demandeur_lien_hk\n\n    from \"wh_dp_silver\".\"int\".\"int_demandeur_foyer\"\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_demandeur_foyer\n)\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demandeur_foyer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:36:01.879836Z", "completed_at": "2025-12-10T16:36:01.884746Z"}, {"name": "execute", "started_at": "2025-12-10T16:36:01.885313Z", "completed_at": "2025-12-10T16:36:10.360334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.48226547241211, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demande_mode_logement_actuel", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demande_mode_logement_actuel\n * Fr\u00e9quence :      Annuel\n * Mode :           Insert/update\n * Source:          int_demande_mode_logement_actuel\n * Cible :          demande_mode_logement_actuel\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_demande_mode_logement_actuel as\n(\n    select\n        demande_mode_logement_actuel_demande_id as demande_id\n        , mode_logement_code\n        , demande_mode_logement_actuel_annee\n        , demande_mode_logement_actuel_annee_last_flag\n        , demande_mode_logement_actuel_ordre_affichage\n        , mode_logement_hk\n        , demande_et_radiation_sne_hk\n\n    from \"wh_dp_silver\".\"int\".\"int_demande_mode_logement_actuel\"\n),\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_demande_mode_logement_actuel\n)\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demande_mode_logement_actuel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:36:10.365193Z", "completed_at": "2025-12-10T16:36:10.370794Z"}, {"name": "execute", "started_at": "2025-12-10T16:36:10.371384Z", "completed_at": "2025-12-10T16:36:42.289818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 31.926345348358154, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demande_sne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demande\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_demande\n * Cible :          demande\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_demande as\n(\n    select\n    -- Identifiants & mill\u00e9simes SNE\n      demande_et_radiation_sne_millesime\n    , demande_et_radiation_sne_millesime_date\n    , demande_et_radiation_sne_millesime_last_flag\n    \n    \n    -- Demande \n    , demande_numero\n    , demande_id\n    , demande_creation_date\n    , demande_motif_premier_code\n    , demande_nouvelle_flag\n    , demande_anciennete_jour_nombre\n    , demande_anciennete_mois_nombre\n    , cerfa_version_code\n\n    -- Demandeur  \n    , demandeur_type_code\n    , demandeur_naissance_date\n    , demandeur_age\n    , demandeur_age_tranche_code\n    , demandeur_statut_professionnel_code\n    , demandeur_situation_familiale_code\n    , demandeur_composition_familiale_code\n    , demandeur_revenu_mensuel_montant\n    \n    -- Foyer \n    , foyer_taille\n    , cotitulaire_nombre\n    , personne_a_charge_nombre\n    , unite_de_consommation_nombre\n    , handicape_nombre\n    , foyer_personne_isole_flag\n    , foyer_couple_flag\n    , foyer_famille_monoparentale_flag\n    , foyer_enfant_nombre\n    , foyer_conjoint_age\n    , foyer_couple_age\n    , foyer_jeune_menage\n    , foyer_revenu_mensuel_montant\n    , foyer_revenu_fiscal_1_montant\n    , foyer_revenu_fiscal_2_montant\n    , apl_mensuel_montant\n\n\n    -- Logement actuel \n    , logement_actuel_categorie_logement_code\n    , logement_actuel_piece_nombre_code\n    , logement_actuel_mode_logement_code\n    , logement_actuel_zone_plafond_ressource_code\n    , logement_actuel_commune_code\n    , logement_actuel_arrondissement_code\n\n   \n\n    -- Logement recherch\u00e9 \n    , logement_recherche_categorie_logement_code\n    , logement_recherche_piece_nombre_code\n    , logement_recherche_commune_code\n    , logement_recherche_zone_plafond_ressource_code\n    , logement_recherche_arrondissement_code\n\n    \n\n    -- Attribution\n    , logement_rpls_id\n    , logement_attribue_piece_nombre_code\n    , logement_attribue_commune_code\n    , logement_attribue_arrondissement_code\n    , logement_attribue_zone_plafond_ressource_code\n    , attribution_date\n    , attribution_delai_jour_nombre\n    , attribution_delai_mois_nombre\n    , attribution_flag\n    , mutation_flag\n    , piece_nombre_adequation_code\n    , reservataire_type_code\n    \n\n    -- Radiation\n    , radiation_date\n    , radiation_motif_code\n    , radiation_hors_attribution_flag\n    , radiation_flag\n    , radiation_siren_numero\n\n    -- DALO\n    , dalo_statut_code\n    , dalo_flag\n    \n\n    -- QPV\n    , qpv_flag\n\n    ---HK/BK\n    , demande_et_radiation_sne_hk\n    , demande_et_radiation_sne_bk\n    , logement_attribue_zone_plafond_ressource_hk\n    , reservataire_type_hk\n    , radiation_motif_hk\n    , dalo_statut_hk\n    , logement_recherche_categorie_logement_hk\n    , logement_recherche_piece_nombre_hk\n    , logement_recherche_zone_plafond_ressource_hk\n    , logement_recherche_commune_hk\n    , logement_recherche_commune_bk\n    , logement_recherche_arrondissement_hk\n    , logement_recherche_arrondissement_bk\n    , logement_actuel_categorie_logement_hk\n    , logement_actuel_piece_nombre_hk\n    , logement_actuel_mode_logement_hk\n    , logement_actuel_zone_plafond_ressource_hk\n    , logement_actuel_commune_hk\n    , logement_actuel_commune_bk\n    , logement_actuel_arrondissement_hk\n    , logement_actuel_arrondissement_bk\n    , demandeur_composition_familiale_hk\n    , demandeur_situation_familiale_hk\n    , demandeur_statut_professionnel_hk\n    , demandeur_age_tranche_hk\n    , demande_motif_premier_hk\n    \n    from \"wh_dp_silver\".\"int\".\"int_demande_sne\"\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_demande\n)\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demande_sne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:36:42.294821Z", "completed_at": "2025-12-10T16:36:42.300649Z"}, {"name": "execute", "started_at": "2025-12-10T16:36:42.301222Z", "completed_at": "2025-12-10T16:37:08.620045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 26.326521635055542, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.radiation_sne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table radiation\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          int_radiation\n * Cible :          demande\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\n-- S\u00e9lection des colonnes \ncte_int_radiation as\n(\n    select\n    -- Identifiants & mill\u00e9simes SNE\n      demande_et_radiation_sne_millesime\n    , demande_et_radiation_sne_millesime_date\n    , demande_et_radiation_sne_millesime_last_flag\n    \n    \n    -- Demande \n    , demande_numero\n    , demande_id\n    , demande_creation_date\n    , demande_motif_premier_code\n    , demande_nouvelle_flag\n    , demande_anciennete_jour_nombre\n    , demande_anciennete_mois_nombre\n    , cerfa_version_code\n\n    -- Demandeur  \n    , demandeur_type_code\n    , demandeur_naissance_date\n    , demandeur_age\n    , demandeur_age_tranche_code\n    , demandeur_statut_professionnel_code\n    , demandeur_situation_familiale_code\n    , demandeur_composition_familiale_code\n    , demandeur_revenu_mensuel_montant\n    \n    -- Foyer \n    , foyer_taille\n    , cotitulaire_nombre\n    , personne_a_charge_nombre\n    , unite_de_consommation_nombre\n    , handicape_nombre\n    , foyer_personne_isole_flag\n    , foyer_couple_flag\n    , foyer_famille_monoparentale_flag\n    , foyer_enfant_nombre\n    , foyer_conjoint_age\n    , foyer_couple_age\n    , foyer_jeune_menage\n    , foyer_revenu_mensuel_montant\n    , foyer_revenu_fiscal_1_montant\n    , foyer_revenu_fiscal_2_montant\n    , apl_mensuel_montant\n\n\n    -- Logement actuel \n    , logement_actuel_categorie_logement_code\n    , logement_actuel_piece_nombre_code\n    , logement_actuel_mode_logement_code\n    , logement_actuel_zone_plafond_ressource_code\n    , logement_actuel_commune_code\n    , logement_actuel_arrondissement_code\n\n   \n\n    -- Logement recherch\u00e9 \n    , logement_recherche_categorie_logement_code\n    , logement_recherche_piece_nombre_code\n    , logement_recherche_commune_code\n    , logement_recherche_zone_plafond_ressource_code\n    , logement_recherche_arrondissement_code\n\n    \n\n    -- Attribution\n    , logement_rpls_id\n    , logement_attribue_piece_nombre_code\n    , logement_attribue_commune_code\n    , logement_attribue_arrondissement_code\n    , logement_attribue_zone_plafond_ressource_code\n    , attribution_date\n    , attribution_delai_jour_nombre\n    , attribution_delai_mois_nombre\n    , attribution_flag\n    , mutation_flag\n    , piece_nombre_adequation_code\n    , reservataire_type_code\n    \n\n    -- Radiation\n    , radiation_date\n    , radiation_motif_code\n    , radiation_hors_attribution_flag\n    , radiation_flag\n    , radiation_siren_numero\n\n    -- DALO\n    , dalo_statut_code\n    , dalo_flag\n    \n\n    -- QPV\n    , qpv_flag\n\n    ---HK/BK\n    , demande_et_radiation_sne_hk\n    , demande_et_radiation_sne_bk\n    , logement_attribue_zone_plafond_ressource_hk\n    , reservataire_type_hk\n    , radiation_motif_hk\n    , dalo_statut_hk\n    , logement_recherche_categorie_logement_hk\n    , logement_recherche_piece_nombre_hk\n    , logement_recherche_zone_plafond_ressource_hk\n    , logement_recherche_commune_hk\n    , logement_recherche_commune_bk\n    , logement_recherche_arrondissement_hk\n    , logement_recherche_arrondissement_bk\n    , logement_actuel_categorie_logement_hk\n    , logement_actuel_piece_nombre_hk\n    , logement_actuel_mode_logement_hk\n    , logement_actuel_zone_plafond_ressource_hk\n    , logement_actuel_commune_hk\n    , logement_actuel_commune_bk\n    , logement_actuel_arrondissement_hk\n    , logement_actuel_arrondissement_bk\n    , demandeur_composition_familiale_hk\n    , demandeur_situation_familiale_hk\n    , demandeur_statut_professionnel_hk\n    , demandeur_age_tranche_hk\n    , demande_motif_premier_hk\n    \n    from \"wh_dp_silver\".\"int\".\"int_radiation_sne\"\n),\n\n-------------------------------------------------------------------\n--************************ ETAPE FINALE **************************\n-------------------------------------------------------------------\n\n-- Ajout des champs techniques\ncte_finale as\n(\n    select\n        *\n        , \n    CAST(SYSDATETIMEOFFSET() AT TIME ZONE 'Romance Standard Time' AS datetime2(3))\n as _meta_loaded_at\n    \n    from cte_int_radiation\n)\n\nselect \n    *\nfrom \n    cte_finale", "relation_name": "\"wh_dp_silver\".\"dbo\".\"radiation_sne\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-10T16:37:08.625666Z", "completed_at": "2025-12-10T16:37:08.630746Z"}, {"name": "execute", "started_at": "2025-12-10T16:37:08.631323Z", "completed_at": "2025-12-10T16:40:28.222388Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 199.59816360473633, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_dataplatform.demande_et_radiation_sne", "compiled": true, "compiled_code": "/**\n *\n * Description :    Alimentation de la table demande_et_radiation_sne\n * Fr\u00e9quence :      Annuel\n * Mode :           Annule et remplace\n * Source:          demande_sne\n                    radiation_sne\n * Cible :          demande_et_radiation_sne\n */\n\n\n\n\nwith\n\n-------------------------------------------------------------------\n--*********************** TABLE EN ENTREE *************************\n-------------------------------------------------------------------\ncte_demande_sne as\n(\n    select *\n    from \"wh_dp_silver\".\"dbo\".\"demande_sne\"\n),\n\ncte_radiation_sne as\n(\n    select *\n    from \"wh_dp_silver\".\"dbo\".\"radiation_sne\"\n),\n\n\n-------------------------------------------------------------------\n--**************************** UNION ******************************\n-------------------------------------------------------------------\ncte_union_demande_et_radiation as\n(\n    select \n        *\n    from cte_demande_sne\n    union\n    select\n        *\n    from cte_radiation_sne\n) \n\n\nselect \n    *\nfrom \n    cte_union_demande_et_radiation", "relation_name": "\"wh_dp_silver\".\"dbo\".\"demande_et_radiation_sne\"", "batch_results": null}], "elapsed_time": 1000.059629201889, "args": {"use_colors_file": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "profiles_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "require_nested_cumulative_type_params": false, "project_dir": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform", "strict_mode": false, "favor_state": false, "write_json": true, "log_level": "info", "use_colors": true, "partial_parse_file_diff": true, "state_modified_compare_vars": false, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "log_format_file": "debug", "print": true, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": false, "warn_error_options": {"include": [], "exclude": []}, "log_path": "C:\\Users\\slhuissier\\dbt-projects\\dbt_dataplatform\\logs", "skip_nodes_if_on_run_start_fails": false, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "exclude": [], "introspect": true, "defer": false, "indirect_selection": "eager", "macro_debugging": false, "invocation_command": "dbt run -s tag:demande", "printer_width": 80, "empty": false, "static_parser": true, "show_resource_report": false, "require_resource_names_without_spaces": false, "select": ["tag:demande"], "quiet": false, "which": "run", "log_format": "default", "populate_cache": true, "log_file_max_bytes": 10485760, "vars": {}}}